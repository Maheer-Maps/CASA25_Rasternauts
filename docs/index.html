<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Nepal Landslides Risk Application</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./images/landslide_icon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-86daaaaad7353f9cc0c554efc1dd6d94.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-47e95e32649f5ea4ff250a3e176ad85f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<style>

      .quarto-title-block .quarto-title-banner {
        background-image: url(images/nepal.png);
background-size: cover;
      }
</style>


<link rel="stylesheet" href="style_gen.css">
</head>

<body>

<div id="quarto-search-results"></div>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Nepal Landslides Risk Application</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#project-summary" id="toc-project-summary" class="nav-link active" data-scroll-target="#project-summary">Project Summary</a>
  <ul class="collapse">
  <li><a href="#problem-statement" id="toc-problem-statement" class="nav-link" data-scroll-target="#problem-statement">Problem Statement</a></li>
  <li><a href="#end-user" id="toc-end-user" class="nav-link" data-scroll-target="#end-user">End User</a></li>
  </ul></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology">Methodology</a>
  <ul class="collapse">
  <li><a href="#susceptibility-model" id="toc-susceptibility-model" class="nav-link" data-scroll-target="#susceptibility-model">Susceptibility Model</a></li>
  <li><a href="#random-forest-model" id="toc-random-forest-model" class="nav-link" data-scroll-target="#random-forest-model">Random Forest Model</a></li>
  </ul></li>
  <li><a href="#interface" id="toc-interface" class="nav-link" data-scroll-target="#interface">Interface</a></li>
  <li><a href="#the-application" id="toc-the-application" class="nav-link" data-scroll-target="#the-application">The Application</a>
  <ul class="collapse">
  <li><a href="#demo" id="toc-demo" class="nav-link" data-scroll-target="#demo">Demo</a></li>
  <li><a href="#key-features-beyond-the-demo" id="toc-key-features-beyond-the-demo" class="nav-link" data-scroll-target="#key-features-beyond-the-demo">Key Features Beyond the Demo</a></li>
  </ul></li>
  <li><a href="#how-it-works" id="toc-how-it-works" class="nav-link" data-scroll-target="#how-it-works">How it Works</a>
  <ul class="collapse">
  <li><a href="#data-preparation-and-precomputations" id="toc-data-preparation-and-precomputations" class="nav-link" data-scroll-target="#data-preparation-and-precomputations">1. Data Preparation and Precomputations</a></li>
  <li><a href="#interactive-visualization-and-analysis" id="toc-interactive-visualization-and-analysis" class="nav-link" data-scroll-target="#interactive-visualization-and-analysis">2. Interactive Visualization and Analysis</a></li>
  <li><a href="#insights-and-objectives" id="toc-insights-and-objectives" class="nav-link" data-scroll-target="#insights-and-objectives">3. Insights and Objectives</a></li>
  <li><a href="#limitations-and-potential-expansion" id="toc-limitations-and-potential-expansion" class="nav-link" data-scroll-target="#limitations-and-potential-expansion">4. Limitations and Potential Expansion</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<section id="project-summary" class="level2">
<h2 class="anchored" data-anchor-id="project-summary">Project Summary</h2>
<p>The project develops an application using Google Earth Engine for policymakers to assess landslide susceptibility in Nepal. The model identifies high-hazard zones using terrain, hydrology, soil, and land cover data, following Hong et al.&nbsp;(2007). Additionally, a machine learning model is tested for accuracy using recent landslide points from the <a href="https://bipadportal.gov.np/incidents/">Bipad Portal</a> (6–13 April 2025). This dual approach allows comparisons between knowledge-based and data-driven methods. The web platform improves hazard communication and supports sustainable landslide inventory mapping, addressing gaps in data-sharing and stakeholder collaboration highlighted by Meena et al.&nbsp;(2021), crucial for Nepal’s disaster management framework.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://link.springer.com/article/10.1007/s11069-006-9104-z"><img src="images/hongetal.png" class="img-fluid figure-img" alt="Global Modelling by Hong et al., 2007"></a></p>
<figcaption>Global Modelling by Hong et al., 2007</figcaption>
</figure>
</div>
<hr>
<section id="problem-statement" class="level3">
<h3 class="anchored" data-anchor-id="problem-statement">Problem Statement</h3>
<p>Almost 80% of Nepal is prone to landslides (Department of Water Induced Disaster Prevention, 2015), creating an urgent need for accessible research on susceptibility. Updating research to identify key factors provides critical insights into vulnerable populations and infrastructure. Yet, outputs often remain disconnected from local needs. Our application addresses this gap by offering an intuitive, Nepali-language platform for policymakers, planners, and stakeholders to visualise high-susceptibility zones. By bridging academic research and local administration, it supports evidence-based mitigation and sustainable landslide inventory mapping (Meena et al., 2021), helping overcome long-standing issues in disaster data sharing, cooperation, and resilience planning.</p>
</section>
<section id="end-user" class="level3">
<h3 class="anchored" data-anchor-id="end-user">End User</h3>
<p>Our platform is designed for hybrid users across academia and administrative bodies involved in landslide management in Nepal. These users need scientifically robust yet accessible tools to inform policies and interventions. Historically, gaps between research and local awareness limited practical outcomes (Meena et al., 2021). By delivering models through a Nepali-language website rather than academic papers, we improve accessibility, usability, and real-world impact. The platform also promotes stakeholder collaboration, strengthening Nepal’s capacity for disaster preparedness, response, and long-term landslide risk reduction (Chalise et al., 2022).</p>
</section>
</section>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<table>
<tbody><tr>
<th>
Category
</th>
<th>
Dataset
</th>
<th>
Description
</th>
<th>
Source
</th>
</tr>
<tr>
<td rowspan="6">
GEE
</td>
<td>
Elevation/Slope
</td>
<td class="description">
NASA SRTM Digital Elevation 30m
</td>
<td>
<a href="https://developers.google.com/earth-engine/datasets/catalog/USGS_SRTMGL1_003">Link</a>
</td>
</tr>
<tr>
<td>
Land Cover
</td>
<td class="description">
MODIS Land Cover Type (2020)
</td>
<td>
<a href="https://developers.google.com/earth-engine/datasets/catalog/MODIS_061_MCD12Q1">Link</a>
</td>
</tr>
<tr>
<td>
Hydrology
</td>
<td class="description">
WWF HydroSHEDS flow accumulation
</td>
<td>
<a href="https://developers.google.com/earth-engine/datasets/catalog/WWF_HydroSHEDS_15ACC">Link</a>
</td>
</tr>
<tr>
<td>
Soil Texture
</td>
<td class="description">
OpenLandMap Soil Texture Class (USDA System)
</td>
<td>
<a href="https://developers.google.com/earth-engine/datasets/catalog/OpenLandMap_SOL_SOL_TEXTURE-CLASS_USDA-TT_M_v02">Link</a>
</td>
</tr>
<tr>
<td>
Soil Type
</td>
<td class="description">
OpenLandMap Clay Content
</td>
<td>
<a href="https://developers.google.com/earth-engine/datasets/catalog/OpenLandMap_SOL_SOL_CLAY-WFRACTION_USDA-3A1A1A_M_v02">Link</a>
</td>
</tr>
<tr>
<td>
Population Density
</td>
<td class="description">
Global Human Settlement Layer of spatial distribution of residential population
</td>
<td>
<a href="https://developers.google.com/earth-engine/datasets/catalog/JRC_GHSL_P2023A_GHS_POP">Link</a>
</td>
</tr>
<tr>
<td rowspan="4">
Other
</td>
<td>
Historical Landslides
</td>
<td class="description">
Official reported landslide incident points (2011 - April 2025)
</td>
<td>
<a href="https://bipadportal.gov.np/incidents/">Link</a>
</td>
</tr>
<tr>
<td>
Census Population
</td>
<td class="description">
Official Population per District 2021 Census
</td>
<td>
<a href="https://censusnepal.cbs.gov.np/results/population#population_size_and_distribution">Link</a>
</td>
</tr>
<tr>
<td>
Country Boundary
</td>
<td class="description">
Official boundary layer for Nepal
</td>
<td>
<a href="https://nationalgeoportal.gov.np/#/metadata/96">Link</a>
</td>
</tr>
<tr>
<td>
Districts Boundaries
</td>
<td class="description">
Official bouundaries of Nepal’s 77 districts
</td>
<td>
<a href="https://nationalgeoportal.gov.np/#/metadata/95p">Link</a>
</td>
</tr>
</tbody></table>
</section>
<section id="methodology" class="level2">
<h2 class="anchored" data-anchor-id="methodology">Methodology</h2>
<section id="susceptibility-model" class="level3">
<h3 class="anchored" data-anchor-id="susceptibility-model">Susceptibility Model</h3>
<p>To recreate Hong et al.’s susceptibility model in GEE, we imported six environmental variables into a weighted linear combination. Each variable was normalized on a 0-1 scale, and in combination with the weights provided a susceptibility score for each pixel. Susceptibility was then normalized 0-1 for the whole of Nepal.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Flowchart1.png" class="img-fluid figure-img"></p>
<figcaption>Susceptibility Model Methodology</figcaption>
</figure>
</div>
<section id="susceptibility-model-code" class="level4">
<h4 class="anchored" data-anchor-id="susceptibility-model-code">Susceptibility Model Code</h4>
<div class="scroll-container" style="overflow-y: scroll; height: 400px; padding:20px ">
<div class="sourceCode" id="cb1"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a> <span class="co">// Import shapefile for country boundaries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> filteredCountries <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">"projects/ee-testing-casa-25/assets/Nepal_boundary"</span>)<span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">centerObject</span>(filteredCountries<span class="op">,</span> <span class="dv">7</span>)<span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">// DEM</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> dem <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(<span class="st">'USGS/SRTMGL1_003'</span>)<span class="op">;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> clippedDem <span class="op">=</span> dem<span class="op">.</span><span class="fu">clip</span>(filteredCountries)<span class="op">;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">// Variable 1: SLOPE</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> slope <span class="op">=</span> ee<span class="op">.</span><span class="at">Terrain</span><span class="op">.</span><span class="fu">slope</span>(clippedDem)<span class="op">;</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> minMaxSlope <span class="op">=</span> slope<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">minMax</span>()<span class="op">,</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometry</span><span class="op">:</span> filteredCountries<span class="op">.</span><span class="fu">geometry</span>()<span class="op">,</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="dt">bestEffort</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> minSlope <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(minMaxSlope<span class="op">.</span><span class="fu">get</span>(<span class="st">'slope_min'</span>))<span class="op">;</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> maxSlope <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(minMaxSlope<span class="op">.</span><span class="fu">get</span>(<span class="st">'slope_max'</span>))<span class="op">;</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> normSlope <span class="op">=</span> slope<span class="op">.</span><span class="fu">subtract</span>(minSlope)<span class="op">.</span><span class="fu">divide</span>(maxSlope<span class="op">.</span><span class="fu">subtract</span>(minSlope))<span class="op">;</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(normSlope<span class="op">,</span> {<span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> [<span class="st">'white'</span><span class="op">,</span> <span class="st">'blue'</span><span class="op">,</span> <span class="st">'green'</span><span class="op">,</span> <span class="st">'yellow'</span><span class="op">,</span> <span class="st">'red'</span>]}<span class="op">,</span> <span class="st">'Nomalised Slope'</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co">// Variable 2: ELEVATION</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> elev <span class="op">=</span> clippedDem<span class="op">;</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> minMaxElevation <span class="op">=</span> elev<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">minMax</span>()<span class="op">,</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometry</span><span class="op">:</span> filteredCountries<span class="op">.</span><span class="fu">geometry</span>()<span class="op">,</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="dt">bestEffort</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> minElev <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(minMaxElevation<span class="op">.</span><span class="fu">get</span>(<span class="st">'elevation_min'</span>))<span class="op">;</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> maxElev <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(minMaxElevation<span class="op">.</span><span class="fu">get</span>(<span class="st">'elevation_max'</span>))<span class="op">;</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> normElev <span class="op">=</span> elev<span class="op">.</span><span class="fu">subtract</span>(minElev)<span class="op">.</span><span class="fu">divide</span>(maxElev<span class="op">.</span><span class="fu">subtract</span>(minElev))<span class="op">;</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(normElev<span class="op">,</span> {<span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> [<span class="st">'white'</span><span class="op">,</span> <span class="st">'blue'</span><span class="op">,</span> <span class="st">'green'</span><span class="op">,</span> <span class="st">'yellow'</span><span class="op">,</span> <span class="st">'red'</span>]}<span class="op">,</span> <span class="st">'Nomalised Elevation'</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co">// Variable 3: MODIS land cover type and reclassification</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> landcover <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">"MODIS/061/MCD12Q1"</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">select</span>(<span class="st">"LC_Type1"</span>)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filterDate</span>(<span class="st">"2023-01-01"</span><span class="op">,</span> <span class="st">"2023-12-31"</span>)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">first</span>()</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">clip</span>(filteredCountries)<span class="op">;</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> reclassifiedLand <span class="op">=</span> landcover<span class="op">.</span><span class="fu">remap</span>(</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">0</span><span class="op">,</span> <span class="dv">15</span><span class="op">,</span> <span class="dv">11</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">9</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">14</span><span class="op">,</span> <span class="dv">16</span><span class="op">,</span> <span class="dv">13</span><span class="op">,</span> <span class="dv">17</span>]<span class="op">,</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="fl">0.1</span><span class="op">,</span> <span class="fl">0.1</span><span class="op">,</span> <span class="fl">0.1</span><span class="op">,</span> <span class="fl">0.2</span><span class="op">,</span> <span class="fl">0.2</span><span class="op">,</span> <span class="fl">0.3</span><span class="op">,</span> <span class="fl">0.4</span><span class="op">,</span> <span class="fl">0.4</span><span class="op">,</span> <span class="fl">0.5</span><span class="op">,</span> <span class="fl">0.5</span><span class="op">,</span> <span class="fl">0.6</span><span class="op">,</span> <span class="fl">0.7</span><span class="op">,</span> <span class="fl">0.8</span><span class="op">,</span> <span class="fl">0.9</span><span class="op">,</span> <span class="fl">1.0</span><span class="op">,</span> <span class="fl">1.0</span>]</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> minMaxLand <span class="op">=</span> reclassifiedLand<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">minMax</span>()<span class="op">,</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometry</span><span class="op">:</span> filteredCountries<span class="op">.</span><span class="fu">geometry</span>()<span class="op">,</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  <span class="dt">bestEffort</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> minLand <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(minMaxLand<span class="op">.</span><span class="fu">get</span>(<span class="st">'remapped_min'</span>))<span class="op">;</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> maxLand <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(minMaxLand<span class="op">.</span><span class="fu">get</span>(<span class="st">'remapped_max'</span>))<span class="op">;</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(reclassifiedLand<span class="op">,</span> {<span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> [<span class="st">'blue'</span><span class="op">,</span> <span class="st">'green'</span><span class="op">,</span> <span class="st">'yellow'</span><span class="op">,</span> <span class="st">'red'</span>]}<span class="op">,</span> <span class="st">"Reclassified Land Cover"</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="co">// Variable 4a: Drainage Density</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> flowAccum <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(<span class="st">"WWF/HydroSHEDS/15ACC"</span>)<span class="op">.</span><span class="fu">clip</span>(filteredCountries)<span class="op">;</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> kernel <span class="op">=</span> ee<span class="op">.</span><span class="at">Kernel</span><span class="op">.</span><span class="fu">circle</span>(<span class="dv">5000</span><span class="op">,</span> <span class="st">'meters'</span>)<span class="op">;</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> threshold <span class="op">=</span> <span class="dv">50</span><span class="op">;</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> streamMask <span class="op">=</span> flowAccum<span class="op">.</span><span class="fu">gt</span>(threshold)<span class="op">;</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> drainageDensity <span class="op">=</span> streamMask<span class="op">.</span><span class="fu">reduceNeighborhood</span>({</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>()<span class="op">,</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  <span class="dt">kernel</span><span class="op">:</span> kernel</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> minMaxDensity <span class="op">=</span> drainageDensity<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">minMax</span>()<span class="op">,</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometry</span><span class="op">:</span> filteredCountries<span class="op">.</span><span class="fu">geometry</span>()<span class="op">,</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  <span class="dt">bestEffort</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> minDensity <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(minMaxDensity<span class="op">.</span><span class="fu">get</span>(<span class="st">'b1_mean_min'</span>))<span class="op">;</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> maxDensity <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(minMaxDensity<span class="op">.</span><span class="fu">get</span>(<span class="st">'b1_mean_max'</span>))<span class="op">;</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> normalizedDrainageDensity <span class="op">=</span> drainageDensity<span class="op">.</span><span class="fu">subtract</span>(minDensity)<span class="op">.</span><span class="fu">divide</span>(maxDensity<span class="op">.</span><span class="fu">subtract</span>(minDensity))<span class="op">;</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(normalizedDrainageDensity<span class="op">,</span> {<span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> [<span class="st">'white'</span><span class="op">,</span> <span class="st">'green'</span><span class="op">,</span> <span class="st">'blue'</span>]}<span class="op">,</span> <span class="st">'Normalised Drainage Density'</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a><span class="co">// Variable 4b: Distance to Drainage</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> streams <span class="op">=</span> flowAccum<span class="op">.</span><span class="fu">gt</span>(threshold)<span class="op">.</span><span class="fu">selfMask</span>()<span class="op">;</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> distanceToDrainage <span class="op">=</span> streams<span class="op">.</span><span class="fu">fastDistanceTransform</span>()<span class="op">.</span><span class="fu">sqrt</span>()<span class="op">.</span><span class="fu">clip</span>(filteredCountries)<span class="op">;</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> minMax <span class="op">=</span> distanceToDrainage<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">minMax</span>()<span class="op">,</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometry</span><span class="op">:</span> filteredCountries<span class="op">.</span><span class="fu">geometry</span>()<span class="op">,</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>  <span class="dt">bestEffort</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> minDist <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(minMax<span class="op">.</span><span class="fu">get</span>(<span class="st">'distance_min'</span>))<span class="op">;</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> maxDist <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(minMax<span class="op">.</span><span class="fu">get</span>(<span class="st">'distance_max'</span>))<span class="op">;</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> normalizedDistance <span class="op">=</span> distanceToDrainage<span class="op">.</span><span class="fu">subtract</span>(minDist)<span class="op">.</span><span class="fu">divide</span>(maxDist<span class="op">.</span><span class="fu">subtract</span>(minDist))<span class="op">;</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>normalizedDistance <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(<span class="dv">1</span>)<span class="op">.</span><span class="fu">subtract</span>(normalizedDistance)<span class="op">;</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(normalizedDistance<span class="op">,</span> {<span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> [<span class="st">"blue"</span><span class="op">,</span> <span class="st">"yellow"</span><span class="op">,</span> <span class="st">"red"</span>]}<span class="op">,</span> <span class="st">"Normalized Distance to Drainage"</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a><span class="co">// Variable 5: Soil Texture (Original)</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> soilTexture <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(<span class="st">"OpenLandMap/SOL/SOL_TEXTURE-CLASS_USDA-TT_M/v02"</span>)<span class="op">.</span><span class="fu">select</span>(<span class="st">"b0"</span>)<span class="op">.</span><span class="fu">clip</span>(filteredCountries)<span class="op">;</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> reclassifiedSoil <span class="op">=</span> soilTexture<span class="op">.</span><span class="fu">remap</span>(</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">9</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">11</span><span class="op">,</span> <span class="dv">12</span>]<span class="op">,</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a> [<span class="dv">3</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>]</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>reclassifiedSoil <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(<span class="dv">4</span>)<span class="op">.</span><span class="fu">subtract</span>(reclassifiedSoil)<span class="op">;</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> minMaxSoilTexture <span class="op">=</span> reclassifiedSoil<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a> <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">minMax</span>()<span class="op">,</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a> <span class="dt">geometry</span><span class="op">:</span> filteredCountries<span class="op">.</span><span class="fu">geometry</span>()<span class="op">,</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a> <span class="dt">scale</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a> <span class="dt">bestEffort</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> minSoil <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(minMaxSoilTexture<span class="op">.</span><span class="fu">get</span>(<span class="st">'constant_min'</span>))<span class="op">;</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> maxSoil <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(minMaxSoilTexture<span class="op">.</span><span class="fu">get</span>(<span class="st">'constant_max'</span>))<span class="op">;</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> normalizedSoilTexture <span class="op">=</span> reclassifiedSoil<span class="op">.</span><span class="fu">subtract</span>(minSoil)<span class="op">.</span><span class="fu">divide</span>(maxSoil<span class="op">.</span><span class="fu">subtract</span>(minSoil))<span class="op">;</span></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(normalizedSoilTexture<span class="op">,</span> {<span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> [<span class="st">"yellow"</span><span class="op">,</span> <span class="st">"green"</span><span class="op">,</span> <span class="st">"red"</span>]}<span class="op">,</span> <span class="st">"Normalised Soil Texture"</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a><span class="co">// Variable 6: Soil Type (Clay %)</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> soilType <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(<span class="st">"OpenLandMap/SOL/SOL_CLAY-WFRACTION_USDA-3A1A1A_M/v02"</span>)<span class="op">.</span><span class="fu">clip</span>(filteredCountries)<span class="op">;</span></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>soilType <span class="op">=</span> soilType<span class="op">.</span><span class="fu">reduce</span>(ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>())<span class="op">;</span></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> minMaxClay <span class="op">=</span> soilType<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">minMax</span>()<span class="op">,</span></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometry</span><span class="op">:</span> filteredCountries<span class="op">.</span><span class="fu">geometry</span>()<span class="op">,</span></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>  <span class="dt">bestEffort</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> minClay <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(minMaxClay<span class="op">.</span><span class="fu">get</span>(<span class="st">'mean_min'</span>))<span class="op">;</span></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> maxClay <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(minMaxClay<span class="op">.</span><span class="fu">get</span>(<span class="st">'mean_max'</span>))<span class="op">;</span></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> normClay <span class="op">=</span> soilType<span class="op">.</span><span class="fu">subtract</span>(minClay)<span class="op">.</span><span class="fu">divide</span>(maxClay<span class="op">.</span><span class="fu">subtract</span>(minClay))<span class="op">;</span></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(normClay<span class="op">.</span><span class="fu">select</span>(<span class="dv">0</span>)<span class="op">,</span> {<span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> [<span class="st">"blue"</span><span class="op">,</span> <span class="st">"yellow"</span><span class="op">,</span> <span class="st">"red"</span>]}<span class="op">,</span> <span class="st">"Normalized Clay Percentage"</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a><span class="co">// Resample all layers</span></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> targetScale <span class="op">=</span> <span class="dv">1000</span><span class="op">;</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> crs <span class="op">=</span> <span class="st">'EPSG:4326'</span><span class="op">;</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>normSlope <span class="op">=</span> normSlope<span class="op">.</span><span class="fu">reproject</span>({<span class="dt">crs</span><span class="op">:</span> crs<span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> targetScale})<span class="op">;</span></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>normalizedDrainageDensity <span class="op">=</span> normalizedDrainageDensity<span class="op">.</span><span class="fu">reproject</span>({<span class="dt">crs</span><span class="op">:</span> crs<span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> targetScale})<span class="op">;</span></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>normalizedDistance <span class="op">=</span> normalizedDistance<span class="op">.</span><span class="fu">reproject</span>({<span class="dt">crs</span><span class="op">:</span> crs<span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> targetScale})<span class="op">;</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>normElev <span class="op">=</span> normElev<span class="op">.</span><span class="fu">reproject</span>({<span class="dt">crs</span><span class="op">:</span> crs<span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> targetScale})<span class="op">;</span></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>normClay <span class="op">=</span> normClay<span class="op">.</span><span class="fu">reproject</span>({<span class="dt">crs</span><span class="op">:</span> crs<span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> targetScale})<span class="op">;</span></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>reclassifiedLand <span class="op">=</span> reclassifiedLand<span class="op">.</span><span class="fu">reproject</span>({<span class="dt">crs</span><span class="op">:</span> crs<span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> targetScale})<span class="op">;</span></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>normalizedSoilTexture <span class="op">=</span> normalizedSoilTexture<span class="op">.</span><span class="fu">reproject</span>({<span class="dt">crs</span><span class="op">:</span> crs<span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> targetScale})<span class="op">;</span></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a><span class="co">// Landslide Susceptibility Model</span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> landslideRisk <span class="op">=</span> normSlope<span class="op">.</span><span class="fu">multiply</span>(<span class="fl">0.3</span>)</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">add</span>(normalizedDrainageDensity<span class="op">.</span><span class="fu">multiply</span>(<span class="fl">0.1</span>))</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>  <span class="co">// .add(normalizedDistance.multiply(0.1)) // optional</span></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">add</span>(normElev<span class="op">.</span><span class="fu">multiply</span>(<span class="fl">0.1</span>))</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">add</span>(normClay<span class="op">.</span><span class="fu">multiply</span>(<span class="fl">0.2</span>))</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">add</span>(reclassifiedLand<span class="op">.</span><span class="fu">multiply</span>(<span class="fl">0.1</span>))</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">add</span>(normalizedSoilTexture<span class="op">.</span><span class="fu">multiply</span>(<span class="fl">0.2</span>))<span class="op">;</span></span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a><span class="co">// Rename the band to "risk"</span></span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> landslideRisk <span class="op">=</span> landslideRisk<span class="op">.</span><span class="fu">rename</span>(<span class="st">'risk'</span>)<span class="op">;</span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> minMaxRiskLandslide <span class="op">=</span> landslideRisk<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">minMax</span>()<span class="op">,</span></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometry</span><span class="op">:</span> filteredCountries<span class="op">.</span><span class="fu">geometry</span>()<span class="op">,</span></span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>  <span class="dt">bestEffort</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> minRisk <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(minMaxRiskLandslide<span class="op">.</span><span class="fu">get</span>(<span class="st">'risk_min'</span>))<span class="op">;</span></span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> maxRisk <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(minMaxRiskLandslide<span class="op">.</span><span class="fu">get</span>(<span class="st">'risk_max'</span>))<span class="op">;</span></span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> normalizedLandslideRisk <span class="op">=</span> landslideRisk<span class="op">.</span><span class="fu">subtract</span>(minRisk)<span class="op">.</span><span class="fu">divide</span>(maxRisk<span class="op">.</span><span class="fu">subtract</span>(minRisk))<span class="op">;</span></span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(normalizedLandslideRisk<span class="op">.</span><span class="fu">select</span>(<span class="dv">0</span>)<span class="op">,</span> {</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>  <span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>  <span class="dt">max</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>  <span class="dt">palette</span><span class="op">:</span> [<span class="st">'green'</span><span class="op">,</span> <span class="st">'yellow'</span><span class="op">,</span> <span class="st">'red'</span>]</span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span> <span class="st">"Normalized Landslide Risk"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="random-forest-model" class="level3">
<h3 class="anchored" data-anchor-id="random-forest-model">Random Forest Model</h3>
<p>To find populated areas most susceptible to landslides, we masked our environmental variables to populated areas, and trained a random forest classifier on landslide and randomly generated non-landslide points from Bipad Portal. Each pixel was scored based on the proportion of decision trees voting landslide.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Flowchart2.png" class="img-fluid figure-img"></p>
<figcaption>Random Forest Model Methodology</figcaption>
</figure>
</div>
<section id="random-forest-model-code" class="level4">
<h4 class="anchored" data-anchor-id="random-forest-model-code">Random Forest Model Code</h4>
<div class="scroll-container" style="overflow-y: scroll; height: 400px; padding:20px ">
<div class="sourceCode" id="cb2"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Population Integration</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Load the Global Human Settlement Layer (GHSL) Population ImageCollection</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> ghslPop <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">'JRC/GHSL/P2023A/GHS_POP'</span>)<span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">// Select the image corresponding to the year 2020 (index 9 in the collection)</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> pop2020 <span class="op">=</span> ghslPop<span class="op">.</span><span class="fu">toList</span>(<span class="dv">12</span>)<span class="op">.</span><span class="fu">get</span>(<span class="dv">9</span>)<span class="op">;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">// Extract the 'population_count' band and clip it to Nepal's boundary</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> popImage <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(pop2020)<span class="op">.</span><span class="fu">select</span>(<span class="st">'population_count'</span>)<span class="op">.</span><span class="fu">clip</span>(NepalBoundary)<span class="op">;</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">// Reproject the population image to 1 km resolution and EPSG:4326 to ensure alignment with the landslide susceptibility model</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> pop1km <span class="op">=</span> popImage</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">reproject</span>({</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">crs</span><span class="op">:</span> crs<span class="op">,</span> <span class="co">// 'EPSG:4326' defined earlier </span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">scale</span><span class="op">:</span> targetScale <span class="co">// 1000 meters defined earlier</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">clip</span>(NepalBoundary)<span class="op">;</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co">//  Visualise the 1km population layer on the map</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co">//   - Pixels with a population density ≥ 500 people/km² will appear fully red.</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co">//   - Pixels with lower densities are stretched linearly between white (0) and red (500).</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(pop1km<span class="op">,</span> {<span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">500</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> [<span class="st">'white'</span><span class="op">,</span> <span class="st">'blue'</span><span class="op">,</span> <span class="st">'red'</span>]}<span class="op">,</span> <span class="st">'GHSL Population (1km)'</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co">// Create a binary population mask</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="co">// 0: No population</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="co">// 1: Some population (any value &gt; 0)</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> popBinary <span class="op">=</span> pop1km<span class="op">.</span><span class="fu">gt</span>(<span class="dv">0</span>)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">rename</span>(<span class="st">'popBinary'</span>)  <span class="co">// rename band for clarity</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">clip</span>(NepalBoundary)<span class="op">;</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="co">// Add the binary layer to the map</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(popBinary<span class="op">,</span> {</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="dt">max</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="dt">palette</span><span class="op">:</span> [<span class="st">'white'</span><span class="op">,</span> <span class="st">'red'</span>]</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span> <span class="st">'Binary Population Mask (0/1)'</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="co">// Visualise the susceptibility model that excludes unpopulated regions</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="co">// Mask landslide risk to populated areas only</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> populatedRisk <span class="op">=</span> landslideRisk<span class="op">.</span><span class="fu">updateMask</span>(popBinary)<span class="op">;</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="co">// Recompute min and max values after masking</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> minMaxPopulatedRisk <span class="op">=</span> populatedRisk<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">minMax</span>()<span class="op">,</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometry</span><span class="op">:</span> NepalBoundary<span class="op">.</span><span class="fu">geometry</span>()<span class="op">,</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">1000</span><span class="op">,</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>  <span class="dt">bestEffort</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a><span class="co">// Extract new min and max</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> minRiskPop <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(minMaxPopulatedRisk<span class="op">.</span><span class="fu">get</span>(<span class="st">'risk_min'</span>))<span class="op">;</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> maxRiskPop <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(minMaxPopulatedRisk<span class="op">.</span><span class="fu">get</span>(<span class="st">'risk_max'</span>))<span class="op">;</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a><span class="co">// Re-normalise the masked risk layer</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> normalizedPopulatedRisk <span class="op">=</span> populatedRisk<span class="op">.</span><span class="fu">subtract</span>(minRiskPop)</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">divide</span>(maxRiskPop<span class="op">.</span><span class="fu">subtract</span>(minRiskPop))</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">rename</span>(<span class="st">'risk'</span>)<span class="op">;</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a><span class="co">// Add the new population-masked susceptibility map to the map</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(normalizedPopulatedRisk<span class="op">,</span> {</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>  <span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>  <span class="dt">max</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>  <span class="dt">palette</span><span class="op">:</span> [<span class="st">'green'</span><span class="op">,</span> <span class="st">'yellow'</span><span class="op">,</span> <span class="st">'red'</span>]</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span> <span class="st">'Normalized Landslide Risk (Populated Areas Only)'</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a><span class="co">// Machine Learning &amp; Evaluation (Dan)</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a><span class="co">// 1. Classify landslide susceptibility zones</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a><span class="co">// select the first band once and use it everywhere</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> risk <span class="op">=</span> normalizedLandslideRisk<span class="op">.</span><span class="fu">select</span>(<span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a><span class="co">// calculate percentiles (tertiles)</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> susceptibilityPercentiles <span class="op">=</span> risk<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">percentile</span>([<span class="dv">33</span><span class="op">,</span> <span class="dv">66</span>])<span class="op">,</span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometry</span><span class="op">:</span> NepalBoundary<span class="op">.</span><span class="fu">geometry</span>()<span class="op">,</span></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>  <span class="dt">bestEffort</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a><span class="co">// extract break values</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> p33 <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(susceptibilityPercentiles<span class="op">.</span><span class="fu">get</span>(<span class="st">'risk_p33'</span>))<span class="op">;</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> p66 <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(susceptibilityPercentiles<span class="op">.</span><span class="fu">get</span>(<span class="st">'risk_p66'</span>))<span class="op">;</span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a><span class="co">// reclassify ones based on percentiles</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> susceptibilityZones <span class="op">=</span> normalizedLandslideRisk</span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">where</span>(normalizedLandslideRisk<span class="op">.</span><span class="fu">lt</span>(p33)<span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">where</span>(normalizedLandslideRisk<span class="op">.</span><span class="fu">gte</span>(p33)<span class="op">.</span><span class="fu">and</span>(normalizedLandslideRisk<span class="op">.</span><span class="fu">lt</span>(p66))<span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">where</span>(normalizedLandslideRisk<span class="op">.</span><span class="fu">gte</span>(p66)<span class="op">,</span> <span class="dv">3</span>)</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">rename</span>(<span class="st">'zone'</span>)</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">updateMask</span>(normalizedLandslideRisk<span class="op">.</span><span class="fu">mask</span>())</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">clip</span>(NepalBoundary)<span class="op">;</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a><span class="co">// Visualise susceptibilityZones layer on the map</span></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(susceptibilityZones<span class="op">,</span> {<span class="dt">min</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> [<span class="st">'green'</span><span class="op">,</span> <span class="st">'yellow'</span><span class="op">,</span> <span class="st">'red'</span>]}<span class="op">,</span> <span class="st">'Susceptibility Zones (Quantile)'</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a><span class="co">// Get pixel count per risk class</span></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> classCounts <span class="op">=</span> susceptibilityZones<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">frequencyHistogram</span>()<span class="op">,</span></span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometry</span><span class="op">:</span> NepalBoundary<span class="op">.</span><span class="fu">geometry</span>()<span class="op">,</span></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>  <span class="dt">bestEffort</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a><span class="co">// 2. Overlay landslide points onto Susceptibility Zones and Evaluate</span></span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a><span class="co">// Source: https://bipadportal.gov.np/incidents/</span></span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> landslidePoints <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">"users/jihunnadi65/landslides_data_v1"</span>)<span class="op">;</span></span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a><span class="co">// Filter to include only points with reported damage</span></span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a><span class="co">// Using only damaged landslides may not be optimal here, since our model aims to capture overall landslide susceptibility</span></span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a><span class="co">// Including only damaged events could intrduce spatial bias for urban areas and compromise predictive power</span></span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a><span class="co">// Instead, we retain all points for evaluation and use damage metrics as supplementary metadata</span></span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> damagedLandslidePoints <span class="op">=</span> landslidePoints<span class="op">.</span><span class="fu">filter</span>(</span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">or</span>(</span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>    ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">gt</span>(<span class="st">'peopleDeathCount'</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">,</span></span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>    ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">gt</span>(<span class="st">'peopleMissingCount'</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">,</span></span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>    ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">gt</span>(<span class="st">'peopleInjuredCount'</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">,</span></span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>    ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">gt</span>(<span class="st">'peopleAffectedCount'</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">,</span></span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>    ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">gt</span>(<span class="st">'infrastructureDestroyedCount'</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a><span class="co">// Optionally filter by year (e.g., to match land cover data or recent terrain condition)</span></span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a><span class="co">// Filter from 2020 onwards reduces sample size from ~4300 to ~2670 points</span></span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a><span class="co">// var recentLandslides = landslidePoints.filter(ee.Filter.gte('year', 2020));</span></span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a><span class="co">// Map.addLayer(recentLandslides, {color: 'orange'}, 'Recent Landslides (2020–2025)');</span></span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a><span class="co">// Visualise all known landslide points</span></span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a><span class="co">// Total = 4,300 points (2011-05-14 to 2025-03-24)</span></span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(landslidePoints<span class="op">,</span> {<span class="dt">pointSize</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">'red'</span>}<span class="op">,</span> <span class="st">'Landslide Points'</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a><span class="co">// Visualise only landslide points with reported damage</span></span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a><span class="co">// Total = 1,994 points in same date range</span></span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(damagedLandslidePoints<span class="op">,</span> {<span class="dt">pointSize</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">'Orange'</span>}<span class="op">,</span> <span class="st">'Damaged Landslide Points'</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a><span class="co">// Sample the susceptibility zone for each landslide point</span></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a><span class="co">// Using scale: 1000 to match the resolution of susceptibility raster (defined earlier as targetScale = 1000)</span></span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> validationSamples <span class="op">=</span> susceptibilityZones<span class="op">.</span><span class="fu">sampleRegions</span>({</span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> landslidePoints<span class="op">,</span></span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">1000</span><span class="op">,</span> <span class="co">// match the resolution of susceptibility raster</span></span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometries</span><span class="op">:</span> <span class="kw">true</span> <span class="co">// retain the original point geometry</span></span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a><span class="co">// Count number of landslide points in each zone (low = 1, medium = 2, high = 3)</span></span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> pointCounts <span class="op">=</span> validationSamples<span class="op">.</span><span class="fu">reduceColumns</span>({</span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>  <span class="dt">selectors</span><span class="op">:</span> [<span class="st">'zone'</span>]<span class="op">,</span></span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">frequencyHistogram</span>()</span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a><span class="co">// Calculate proportions for comparion</span></span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> countsDict <span class="op">=</span> ee<span class="op">.</span><span class="fu">Dictionary</span>(pointCounts<span class="op">.</span><span class="fu">get</span>(<span class="st">'histogram'</span>))<span class="op">;</span></span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> totalPoints <span class="op">=</span> countsDict<span class="op">.</span><span class="fu">values</span>()<span class="op">.</span><span class="fu">reduce</span>(ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">sum</span>())<span class="op">;</span></span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> proportions <span class="op">=</span> countsDict<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(key<span class="op">,</span> value) {</span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ee<span class="op">.</span><span class="fu">Number</span>(value)<span class="op">.</span><span class="fu">divide</span>(totalPoints)<span class="op">.</span><span class="fu">multiply</span>(<span class="dv">100</span>)<span class="op">;</span></span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a><span class="co">// Control test: Generate random points across Nepal to compare spatial bias</span></span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a><span class="co">// This helps determine whether landslides fall in high-risk zones more than expected by chance</span></span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> randomPoints <span class="op">=</span> ee<span class="op">.</span><span class="at">FeatureCollection</span><span class="op">.</span><span class="fu">randomPoints</span>({</span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> NepalBoundary<span class="op">.</span><span class="fu">geometry</span>()<span class="op">,</span></span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>  <span class="dt">points</span><span class="op">:</span> landslidePoints<span class="op">.</span><span class="fu">size</span>()<span class="op">,</span> <span class="co">// match number of real landslide points</span></span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>  <span class="dt">seed</span><span class="op">:</span> <span class="dv">42</span> <span class="co">// use a fixed seed (42) to ensure reproducibility of random point generation across runs</span></span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a><span class="co">// Sample susceptibility zone at random points</span></span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> randomSamples <span class="op">=</span> susceptibilityZones<span class="op">.</span><span class="fu">sampleRegions</span>({</span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> randomPoints<span class="op">,</span></span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">1000</span><span class="op">,</span></span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometries</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a><span class="co">// Histogram of real landslide zones</span></span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> realCounts <span class="op">=</span> susceptibilityZones<span class="op">.</span><span class="fu">sampleRegions</span>({</span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> landslidePoints<span class="op">,</span></span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">1000</span></span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="fu">reduceColumns</span>({</span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a>  <span class="dt">selectors</span><span class="op">:</span> [<span class="st">'zone'</span>]<span class="op">,</span></span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">frequencyHistogram</span>()</span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a><span class="co">// Histogram of control group (random control points)</span></span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> randomCounts <span class="op">=</span> randomSamples<span class="op">.</span><span class="fu">reduceColumns</span>({</span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true" tabindex="-1"></a>  <span class="dt">selectors</span><span class="op">:</span> [<span class="st">'zone'</span>]<span class="op">,</span></span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">frequencyHistogram</span>()</span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-190"><a href="#cb2-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-191"><a href="#cb2-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-192"><a href="#cb2-192" aria-hidden="true" tabindex="-1"></a><span class="co">// 3.Chi-Square Test for Statistical Significance</span></span>
<span id="cb2-193"><a href="#cb2-193" aria-hidden="true" tabindex="-1"></a><span class="co">// This test checks whether the distribution of landslide points across rik zones</span></span>
<span id="cb2-194"><a href="#cb2-194" aria-hidden="true" tabindex="-1"></a><span class="co">// significantly differs from what would be expected by chance (random distribution)</span></span>
<span id="cb2-195"><a href="#cb2-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-196"><a href="#cb2-196" aria-hidden="true" tabindex="-1"></a><span class="co">// Extract observed (real) and expected (random) point distribution by zone</span></span>
<span id="cb2-197"><a href="#cb2-197" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> realDict <span class="op">=</span> ee<span class="op">.</span><span class="fu">Dictionary</span>(realCounts<span class="op">.</span><span class="fu">get</span>(<span class="st">'histogram'</span>))<span class="op">;</span></span>
<span id="cb2-198"><a href="#cb2-198" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> randomDict <span class="op">=</span> ee<span class="op">.</span><span class="fu">Dictionary</span>(randomCounts<span class="op">.</span><span class="fu">get</span>(<span class="st">'histogram'</span>))<span class="op">;</span></span>
<span id="cb2-199"><a href="#cb2-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-200"><a href="#cb2-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-201"><a href="#cb2-201" aria-hidden="true" tabindex="-1"></a><span class="co">// Apply Chi-Square formula: sum((O - E)^2 / E) for each risk class</span></span>
<span id="cb2-202"><a href="#cb2-202" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> keys <span class="op">=</span> realDict<span class="op">.</span><span class="fu">keys</span>()<span class="op">;</span> <span class="co">// ['1', '2', '3']</span></span>
<span id="cb2-203"><a href="#cb2-203" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> chiSquare <span class="op">=</span> keys<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(key) {</span>
<span id="cb2-204"><a href="#cb2-204" aria-hidden="true" tabindex="-1"></a>  key <span class="op">=</span> ee<span class="op">.</span><span class="fu">String</span>(key)<span class="op">;</span></span>
<span id="cb2-205"><a href="#cb2-205" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> observed <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(realDict<span class="op">.</span><span class="fu">get</span>(key))<span class="op">;</span></span>
<span id="cb2-206"><a href="#cb2-206" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> expected <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(randomDict<span class="op">.</span><span class="fu">get</span>(key))<span class="op">.</span><span class="fu">max</span>(<span class="dv">1</span>)<span class="op">;</span> <span class="co">// prevision division by 0</span></span>
<span id="cb2-207"><a href="#cb2-207" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> observed<span class="op">.</span><span class="fu">subtract</span>(expected)<span class="op">.</span><span class="fu">pow</span>(<span class="dv">2</span>)<span class="op">.</span><span class="fu">divide</span>(expected)<span class="op">;</span></span>
<span id="cb2-208"><a href="#cb2-208" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-209"><a href="#cb2-209" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> chiSquareTotal <span class="op">=</span> chiSquare<span class="op">.</span><span class="fu">reduce</span>(ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">sum</span>())<span class="op">;</span></span>
<span id="cb2-210"><a href="#cb2-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-211"><a href="#cb2-211" aria-hidden="true" tabindex="-1"></a><span class="co">// With 3 susceptibility classes, degree of freedom (df)= 2</span></span>
<span id="cb2-212"><a href="#cb2-212" aria-hidden="true" tabindex="-1"></a><span class="co">// Reference critical values</span></span>
<span id="cb2-213"><a href="#cb2-213" aria-hidden="true" tabindex="-1"></a><span class="co">// 95% confidence: 5.991, 99%: 9.210, 99.9%: 13.82</span></span>
<span id="cb2-214"><a href="#cb2-214" aria-hidden="true" tabindex="-1"></a><span class="co">// Chi-square value of 835.16 is significantly higher than all reference thresholds for statistical significance</span></span>
<span id="cb2-215"><a href="#cb2-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-216"><a href="#cb2-216" aria-hidden="true" tabindex="-1"></a><span class="co">// 4. Binary Evaluation Using Confusion Matrix</span></span>
<span id="cb2-217"><a href="#cb2-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-218"><a href="#cb2-218" aria-hidden="true" tabindex="-1"></a><span class="co">// Build a Binary Confusion Matrix (High Risk = Zone 3, Not High Risk = Zone 1 + 2)</span></span>
<span id="cb2-219"><a href="#cb2-219" aria-hidden="true" tabindex="-1"></a><span class="co">// Did a landslide point fall in a high-risk zone (True Positive)?</span></span>
<span id="cb2-220"><a href="#cb2-220" aria-hidden="true" tabindex="-1"></a><span class="co">// Did a random (non-landslide) point fall in a high-risk zone (False Positive)?</span></span>
<span id="cb2-221"><a href="#cb2-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-222"><a href="#cb2-222" aria-hidden="true" tabindex="-1"></a><span class="co">// Assign class = 1 to actual landslide points</span></span>
<span id="cb2-223"><a href="#cb2-223" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> realLabeled <span class="op">=</span> susceptibilityZones<span class="op">.</span><span class="fu">sampleRegions</span>({</span>
<span id="cb2-224"><a href="#cb2-224" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> landslidePoints<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(f) {</span>
<span id="cb2-225"><a href="#cb2-225" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> f<span class="op">.</span><span class="fu">set</span>(<span class="st">'label'</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span> <span class="co">// positive class</span></span>
<span id="cb2-226"><a href="#cb2-226" aria-hidden="true" tabindex="-1"></a>  })<span class="op">,</span></span>
<span id="cb2-227"><a href="#cb2-227" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">1000</span></span>
<span id="cb2-228"><a href="#cb2-228" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-229"><a href="#cb2-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-230"><a href="#cb2-230" aria-hidden="true" tabindex="-1"></a><span class="co">// Assign class = 0 to random control points (no landslide)</span></span>
<span id="cb2-231"><a href="#cb2-231" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> randomLabeled <span class="op">=</span> susceptibilityZones<span class="op">.</span><span class="fu">sampleRegions</span>({</span>
<span id="cb2-232"><a href="#cb2-232" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> randomPoints<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(f) {</span>
<span id="cb2-233"><a href="#cb2-233" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> f<span class="op">.</span><span class="fu">set</span>(<span class="st">'label'</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span> <span class="co">// Negative class</span></span>
<span id="cb2-234"><a href="#cb2-234" aria-hidden="true" tabindex="-1"></a>  })<span class="op">,</span></span>
<span id="cb2-235"><a href="#cb2-235" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">1000</span></span>
<span id="cb2-236"><a href="#cb2-236" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-237"><a href="#cb2-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-238"><a href="#cb2-238" aria-hidden="true" tabindex="-1"></a><span class="co">// Combine all labeled points into one dataset</span></span>
<span id="cb2-239"><a href="#cb2-239" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> allPoints <span class="op">=</span> realLabeled<span class="op">.</span><span class="fu">merge</span>(randomLabeled)<span class="op">;</span></span>
<span id="cb2-240"><a href="#cb2-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-241"><a href="#cb2-241" aria-hidden="true" tabindex="-1"></a><span class="co">// Generate binary predictions:</span></span>
<span id="cb2-242"><a href="#cb2-242" aria-hidden="true" tabindex="-1"></a><span class="co">// Predicted = 1 if Zone 3 (high-risk); else 0</span></span>
<span id="cb2-243"><a href="#cb2-243" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> predictions <span class="op">=</span> allPoints<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(f) {</span>
<span id="cb2-244"><a href="#cb2-244" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> zone <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(f<span class="op">.</span><span class="fu">get</span>(<span class="st">'zone'</span>))<span class="op">;</span></span>
<span id="cb2-245"><a href="#cb2-245" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> predicted <span class="op">=</span> zone<span class="op">.</span><span class="fu">eq</span>(<span class="dv">3</span>)<span class="op">;</span> <span class="co">// binary risk</span></span>
<span id="cb2-246"><a href="#cb2-246" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> f<span class="op">.</span><span class="fu">set</span>(<span class="st">'predicted'</span><span class="op">,</span> predicted)<span class="op">;</span></span>
<span id="cb2-247"><a href="#cb2-247" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-248"><a href="#cb2-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-249"><a href="#cb2-249" aria-hidden="true" tabindex="-1"></a><span class="co">// Compute confusion matrix: compares predicted vs actual labels</span></span>
<span id="cb2-250"><a href="#cb2-250" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> confusion <span class="op">=</span> predictions<span class="op">.</span><span class="fu">errorMatrix</span>(<span class="st">'label'</span><span class="op">,</span> <span class="st">'predicted'</span>)<span class="op">;</span></span>
<span id="cb2-251"><a href="#cb2-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-252"><a href="#cb2-252" aria-hidden="true" tabindex="-1"></a><span class="co">// Extract underlying array from the error matrix</span></span>
<span id="cb2-253"><a href="#cb2-253" aria-hidden="true" tabindex="-1"></a><span class="co">// [[TN, FP],</span></span>
<span id="cb2-254"><a href="#cb2-254" aria-hidden="true" tabindex="-1"></a><span class="co">//  [FN, TP]]</span></span>
<span id="cb2-255"><a href="#cb2-255" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> cmArray <span class="op">=</span> ee<span class="op">.</span><span class="fu">Array</span>(confusion<span class="op">.</span><span class="fu">array</span>())<span class="op">;</span></span>
<span id="cb2-256"><a href="#cb2-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-257"><a href="#cb2-257" aria-hidden="true" tabindex="-1"></a><span class="co">// Extract key elements from the matrix:</span></span>
<span id="cb2-258"><a href="#cb2-258" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> TP <span class="op">=</span> cmArray<span class="op">.</span><span class="fu">get</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>])<span class="op">;</span> <span class="co">// True Positive: correctly predicted landslide</span></span>
<span id="cb2-259"><a href="#cb2-259" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> FP <span class="op">=</span> cmArray<span class="op">.</span><span class="fu">get</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>])<span class="op">;</span> <span class="co">// False Positive: predicted landslide but no event</span></span>
<span id="cb2-260"><a href="#cb2-260" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> FN <span class="op">=</span> cmArray<span class="op">.</span><span class="fu">get</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span> <span class="co">// False Negative: missed actual landslide</span></span>
<span id="cb2-261"><a href="#cb2-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-262"><a href="#cb2-262" aria-hidden="true" tabindex="-1"></a><span class="co">// Compute Precision (Producer's Accuracy):</span></span>
<span id="cb2-263"><a href="#cb2-263" aria-hidden="true" tabindex="-1"></a><span class="co">// Of all predicted landslides, what proportion were actual landslides?</span></span>
<span id="cb2-264"><a href="#cb2-264" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> precision <span class="op">=</span> TP<span class="op">.</span><span class="fu">divide</span>(TP<span class="op">.</span><span class="fu">add</span>(FP))<span class="op">;</span></span>
<span id="cb2-265"><a href="#cb2-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-266"><a href="#cb2-266" aria-hidden="true" tabindex="-1"></a><span class="co">// Compute Recall (Consumer's Accuracy):</span></span>
<span id="cb2-267"><a href="#cb2-267" aria-hidden="true" tabindex="-1"></a><span class="co">// Of all actual landslides, what proportion were correctly predicted?</span></span>
<span id="cb2-268"><a href="#cb2-268" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> recall <span class="op">=</span> TP<span class="op">.</span><span class="fu">divide</span>(TP<span class="op">.</span><span class="fu">add</span>(FN))<span class="op">;</span></span>
<span id="cb2-269"><a href="#cb2-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-270"><a href="#cb2-270" aria-hidden="true" tabindex="-1"></a><span class="co">// Compute F1 Score:</span></span>
<span id="cb2-271"><a href="#cb2-271" aria-hidden="true" tabindex="-1"></a><span class="co">// Harmonic mean of precision and recall, balances false positives and false negatives</span></span>
<span id="cb2-272"><a href="#cb2-272" aria-hidden="true" tabindex="-1"></a><span class="co">// .max(1) avoids division by zero</span></span>
<span id="cb2-273"><a href="#cb2-273" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> f1 <span class="op">=</span> precision<span class="op">.</span><span class="fu">multiply</span>(recall)<span class="op">.</span><span class="fu">multiply</span>(<span class="dv">2</span>)<span class="op">.</span><span class="fu">divide</span>(precision<span class="op">.</span><span class="fu">add</span>(recall)<span class="op">.</span><span class="fu">max</span>(<span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb2-274"><a href="#cb2-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-275"><a href="#cb2-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-276"><a href="#cb2-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-277"><a href="#cb2-277" aria-hidden="true" tabindex="-1"></a><span class="co">// Accuracy = 0.59 - The model correctly classified 59% of all validation points (landslide + non-landslide)</span></span>
<span id="cb2-278"><a href="#cb2-278" aria-hidden="true" tabindex="-1"></a><span class="co">// Precision = 0.61 - Of all 1km² areas predicted as high-risk, 61% had a landslide</span></span>
<span id="cb2-279"><a href="#cb2-279" aria-hidden="true" tabindex="-1"></a><span class="co">// Recall = 0.50 - The model correctly identified 50% of actual landslides (some were missed, falling in lower-risk zones)</span></span>
<span id="cb2-280"><a href="#cb2-280" aria-hidden="true" tabindex="-1"></a><span class="co">// F1 Score = 0.55 - A balanced metric combining precision and recall, reflecting moderate overall predictive performance</span></span>
<span id="cb2-281"><a href="#cb2-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-282"><a href="#cb2-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-283"><a href="#cb2-283" aria-hidden="true" tabindex="-1"></a><span class="co">// 5. Random Forest Classifier</span></span>
<span id="cb2-284"><a href="#cb2-284" aria-hidden="true" tabindex="-1"></a><span class="co">// Assign class = 1 for known landslide points</span></span>
<span id="cb2-285"><a href="#cb2-285" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> landslideLabeled <span class="op">=</span> landslidePoints<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(f) {</span>
<span id="cb2-286"><a href="#cb2-286" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> f<span class="op">.</span><span class="fu">set</span>(<span class="st">'class'</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span> <span class="co">// positive class (landslide occurred)</span></span>
<span id="cb2-287"><a href="#cb2-287" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-288"><a href="#cb2-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-289"><a href="#cb2-289" aria-hidden="true" tabindex="-1"></a><span class="co">// Generate random negative points with class = 0</span></span>
<span id="cb2-290"><a href="#cb2-290" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> nonLandslidePoints <span class="op">=</span> ee<span class="op">.</span><span class="at">FeatureCollection</span><span class="op">.</span><span class="fu">randomPoints</span>({</span>
<span id="cb2-291"><a href="#cb2-291" aria-hidden="true" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> NepalBoundary<span class="op">.</span><span class="fu">geometry</span>()<span class="op">,</span></span>
<span id="cb2-292"><a href="#cb2-292" aria-hidden="true" tabindex="-1"></a>  <span class="dt">points</span><span class="op">:</span> landslidePoints<span class="op">.</span><span class="fu">size</span>()<span class="op">,</span> <span class="co">// match number as positive class for balanced training</span></span>
<span id="cb2-293"><a href="#cb2-293" aria-hidden="true" tabindex="-1"></a>  <span class="dt">seed</span><span class="op">:</span> <span class="dv">42</span> <span class="co">// set seed for reproducibility</span></span>
<span id="cb2-294"><a href="#cb2-294" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(f) {</span>
<span id="cb2-295"><a href="#cb2-295" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> f<span class="op">.</span><span class="fu">set</span>(<span class="st">'class'</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span> <span class="co">// negative class (assumed no landslide)</span></span>
<span id="cb2-296"><a href="#cb2-296" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-297"><a href="#cb2-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-298"><a href="#cb2-298" aria-hidden="true" tabindex="-1"></a><span class="co">// Merge positive and negative samples into one training dataset</span></span>
<span id="cb2-299"><a href="#cb2-299" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trainingPoints <span class="op">=</span> landslideLabeled<span class="op">.</span><span class="fu">merge</span>(nonLandslidePoints)<span class="op">;</span></span>
<span id="cb2-300"><a href="#cb2-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-301"><a href="#cb2-301" aria-hidden="true" tabindex="-1"></a><span class="co">// Build feature stack of predictors</span></span>
<span id="cb2-302"><a href="#cb2-302" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> featuresImage <span class="op">=</span> ee<span class="op">.</span><span class="at">Image</span><span class="op">.</span><span class="fu">cat</span>([</span>
<span id="cb2-303"><a href="#cb2-303" aria-hidden="true" tabindex="-1"></a>  normSlope<span class="op">,</span> <span class="co">// slope</span></span>
<span id="cb2-304"><a href="#cb2-304" aria-hidden="true" tabindex="-1"></a>  normalizedDrainageDensity<span class="op">,</span> <span class="co">// drainage density</span></span>
<span id="cb2-305"><a href="#cb2-305" aria-hidden="true" tabindex="-1"></a>  <span class="co">// normalizedDistance, // optional</span></span>
<span id="cb2-306"><a href="#cb2-306" aria-hidden="true" tabindex="-1"></a>  normElev<span class="op">,</span> <span class="co">// elevation</span></span>
<span id="cb2-307"><a href="#cb2-307" aria-hidden="true" tabindex="-1"></a>  normClay<span class="op">,</span> <span class="co">// clay content</span></span>
<span id="cb2-308"><a href="#cb2-308" aria-hidden="true" tabindex="-1"></a>  reclassifiedLand<span class="op">,</span> <span class="co">// reclassified MODIS land cover</span></span>
<span id="cb2-309"><a href="#cb2-309" aria-hidden="true" tabindex="-1"></a>  normalizedSoilTexture <span class="co">// reclassified soil texture</span></span>
<span id="cb2-310"><a href="#cb2-310" aria-hidden="true" tabindex="-1"></a>])<span class="op">.</span><span class="fu">rename</span>([</span>
<span id="cb2-311"><a href="#cb2-311" aria-hidden="true" tabindex="-1"></a>  <span class="st">'slope'</span><span class="op">,</span> <span class="st">'drainDen'</span><span class="op">,</span> <span class="st">'elev'</span><span class="op">,</span> <span class="st">'clay'</span><span class="op">,</span> <span class="st">'landcover'</span><span class="op">,</span> <span class="st">'soiltex'</span></span>
<span id="cb2-312"><a href="#cb2-312" aria-hidden="true" tabindex="-1"></a>])<span class="op">;</span></span>
<span id="cb2-313"><a href="#cb2-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-314"><a href="#cb2-314" aria-hidden="true" tabindex="-1"></a><span class="co">// Sample predictor values at point locations</span></span>
<span id="cb2-315"><a href="#cb2-315" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> training <span class="op">=</span> featuresImage<span class="op">.</span><span class="fu">sampleRegions</span>({</span>
<span id="cb2-316"><a href="#cb2-316" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> trainingPoints<span class="op">,</span></span>
<span id="cb2-317"><a href="#cb2-317" aria-hidden="true" tabindex="-1"></a>  <span class="dt">properties</span><span class="op">:</span> [<span class="st">'class'</span>]<span class="op">,</span> <span class="co">// target label</span></span>
<span id="cb2-318"><a href="#cb2-318" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">1000</span> <span class="co">// match input raster resolution</span></span>
<span id="cb2-319"><a href="#cb2-319" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-320"><a href="#cb2-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-321"><a href="#cb2-321" aria-hidden="true" tabindex="-1"></a><span class="co">// Train a Random Forest Classifier (50 trees)</span></span>
<span id="cb2-322"><a href="#cb2-322" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> classifier <span class="op">=</span> ee<span class="op">.</span><span class="at">Classifier</span><span class="op">.</span><span class="fu">smileRandomForest</span>(<span class="dv">50</span>)<span class="op">.</span><span class="fu">train</span>({</span>
<span id="cb2-323"><a href="#cb2-323" aria-hidden="true" tabindex="-1"></a>  <span class="dt">features</span><span class="op">:</span> training<span class="op">,</span></span>
<span id="cb2-324"><a href="#cb2-324" aria-hidden="true" tabindex="-1"></a>  <span class="dt">classProperty</span><span class="op">:</span> <span class="st">'class'</span><span class="op">,</span></span>
<span id="cb2-325"><a href="#cb2-325" aria-hidden="true" tabindex="-1"></a>  <span class="dt">inputProperties</span><span class="op">:</span> [<span class="st">'slope'</span><span class="op">,</span> <span class="st">'drainDen'</span><span class="op">,</span> <span class="st">'elev'</span><span class="op">,</span> <span class="st">'clay'</span><span class="op">,</span> <span class="st">'landcover'</span><span class="op">,</span> <span class="st">'soiltex'</span>]</span>
<span id="cb2-326"><a href="#cb2-326" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-327"><a href="#cb2-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-328"><a href="#cb2-328" aria-hidden="true" tabindex="-1"></a><span class="co">// Apply classifier to raster to generate prediction map</span></span>
<span id="cb2-329"><a href="#cb2-329" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> classified <span class="op">=</span> featuresImage<span class="op">.</span><span class="fu">classify</span>(classifier)<span class="op">;</span></span>
<span id="cb2-330"><a href="#cb2-330" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(classified<span class="op">,</span> {<span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> [<span class="st">'white'</span><span class="op">,</span> <span class="st">'red'</span>]}<span class="op">,</span> <span class="st">'RF Landslide Prediction'</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb2-331"><a href="#cb2-331" aria-hidden="true" tabindex="-1"></a><span class="co">// white = low probability, red = high probability of landslide occurrences</span></span>
<span id="cb2-332"><a href="#cb2-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-333"><a href="#cb2-333" aria-hidden="true" tabindex="-1"></a><span class="co">// Create a probability classifier by setting output mode to PROBABILITY</span></span>
<span id="cb2-334"><a href="#cb2-334" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> probabilityClassifier <span class="op">=</span> classifier<span class="op">.</span><span class="fu">setOutputMode</span>(<span class="st">'PROBABILITY'</span>)<span class="op">;</span></span>
<span id="cb2-335"><a href="#cb2-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-336"><a href="#cb2-336" aria-hidden="true" tabindex="-1"></a><span class="co">// Classify the image with the probability classifier</span></span>
<span id="cb2-337"><a href="#cb2-337" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> probabilityMap <span class="op">=</span> featuresImage<span class="op">.</span><span class="fu">classify</span>(probabilityClassifier)<span class="op">;</span></span>
<span id="cb2-338"><a href="#cb2-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-339"><a href="#cb2-339" aria-hidden="true" tabindex="-1"></a><span class="co">// Visualise the probability map (0 = low risk, 1 = high risk)</span></span>
<span id="cb2-340"><a href="#cb2-340" aria-hidden="true" tabindex="-1"></a><span class="co">// This is more interpretable than just a binary yes/no map</span></span>
<span id="cb2-341"><a href="#cb2-341" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(probabilityMap<span class="op">,</span> {</span>
<span id="cb2-342"><a href="#cb2-342" aria-hidden="true" tabindex="-1"></a>  <span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb2-343"><a href="#cb2-343" aria-hidden="true" tabindex="-1"></a>  <span class="dt">max</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb2-344"><a href="#cb2-344" aria-hidden="true" tabindex="-1"></a>  <span class="dt">palette</span><span class="op">:</span> [<span class="st">'white'</span><span class="op">,</span> <span class="st">'yellow'</span><span class="op">,</span> <span class="st">'orange'</span><span class="op">,</span> <span class="st">'red'</span>]</span>
<span id="cb2-345"><a href="#cb2-345" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span> <span class="st">'RF Landslide Probability'</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb2-346"><a href="#cb2-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-347"><a href="#cb2-347" aria-hidden="true" tabindex="-1"></a><span class="co">// Accuracy Assessment</span></span>
<span id="cb2-348"><a href="#cb2-348" aria-hidden="true" tabindex="-1"></a><span class="co">// Split training data into train/test sets using a random column</span></span>
<span id="cb2-349"><a href="#cb2-349" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> withRandom <span class="op">=</span> training<span class="op">.</span><span class="fu">randomColumn</span>(<span class="st">'random'</span>)<span class="op">;</span> <span class="co">// adds column 'random' between 0-1</span></span>
<span id="cb2-350"><a href="#cb2-350" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> split <span class="op">=</span> <span class="fl">0.7</span><span class="op">;</span></span>
<span id="cb2-351"><a href="#cb2-351" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trainSet <span class="op">=</span> withRandom<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">lt</span>(<span class="st">'random'</span><span class="op">,</span> split))<span class="op">;</span> <span class="co">// 70% for training</span></span>
<span id="cb2-352"><a href="#cb2-352" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> valSet <span class="op">=</span> withRandom<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">gte</span>(<span class="st">'random'</span><span class="op">,</span> split))<span class="op">;</span> <span class="co">// 30% for validation</span></span>
<span id="cb2-353"><a href="#cb2-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-354"><a href="#cb2-354" aria-hidden="true" tabindex="-1"></a><span class="co">// Re-train on 70% subset</span></span>
<span id="cb2-355"><a href="#cb2-355" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trainedRF <span class="op">=</span> ee<span class="op">.</span><span class="at">Classifier</span><span class="op">.</span><span class="fu">smileRandomForest</span>(<span class="dv">50</span>)<span class="op">.</span><span class="fu">train</span>({</span>
<span id="cb2-356"><a href="#cb2-356" aria-hidden="true" tabindex="-1"></a>  <span class="dt">features</span><span class="op">:</span> trainSet<span class="op">,</span></span>
<span id="cb2-357"><a href="#cb2-357" aria-hidden="true" tabindex="-1"></a>  <span class="dt">classProperty</span><span class="op">:</span> <span class="st">'class'</span><span class="op">,</span></span>
<span id="cb2-358"><a href="#cb2-358" aria-hidden="true" tabindex="-1"></a>  <span class="dt">inputProperties</span><span class="op">:</span> [<span class="st">'slope'</span><span class="op">,</span> <span class="st">'drainDen'</span><span class="op">,</span> <span class="st">'elev'</span><span class="op">,</span> <span class="st">'clay'</span><span class="op">,</span> <span class="st">'landcover'</span><span class="op">,</span> <span class="st">'soiltex'</span>]</span>
<span id="cb2-359"><a href="#cb2-359" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-360"><a href="#cb2-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-361"><a href="#cb2-361" aria-hidden="true" tabindex="-1"></a><span class="co">// Filter out validation points with any null feature</span></span>
<span id="cb2-362"><a href="#cb2-362" aria-hidden="true" tabindex="-1"></a><span class="co">// Classify the validation set using the re-trained RF model</span></span>
<span id="cb2-363"><a href="#cb2-363" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> validated <span class="op">=</span> valSet<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">notNull</span>([<span class="st">'slope'</span><span class="op">,</span> <span class="st">'drainDen'</span><span class="op">,</span> <span class="st">'elev'</span><span class="op">,</span> <span class="st">'clay'</span><span class="op">,</span> <span class="st">'landcover'</span><span class="op">,</span> <span class="st">'soiltex'</span>]))</span>
<span id="cb2-364"><a href="#cb2-364" aria-hidden="true" tabindex="-1"></a>                      <span class="op">.</span><span class="fu">classify</span>(trainedRF)<span class="op">;</span></span>
<span id="cb2-365"><a href="#cb2-365" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb2-366"><a href="#cb2-366" aria-hidden="true" tabindex="-1"></a><span class="co">// generate a confusion matrix by comparing true labels with predicted ones</span></span>
<span id="cb2-367"><a href="#cb2-367" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> rfMatrix <span class="op">=</span> validated<span class="op">.</span><span class="fu">errorMatrix</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'classification'</span>)<span class="op">;</span></span>
<span id="cb2-368"><a href="#cb2-368" aria-hidden="true" tabindex="-1"></a><span class="co">// Extract array from RF confusion matrix</span></span>
<span id="cb2-369"><a href="#cb2-369" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> rfArray <span class="op">=</span> ee<span class="op">.</span><span class="fu">Array</span>(rfMatrix<span class="op">.</span><span class="fu">array</span>())<span class="op">;</span></span>
<span id="cb2-370"><a href="#cb2-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-371"><a href="#cb2-371" aria-hidden="true" tabindex="-1"></a><span class="co">// Extract individual values for binary classification</span></span>
<span id="cb2-372"><a href="#cb2-372" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> TP_rf <span class="op">=</span> rfArray<span class="op">.</span><span class="fu">get</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>])<span class="op">;</span> <span class="co">// True Positive</span></span>
<span id="cb2-373"><a href="#cb2-373" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> FP_rf <span class="op">=</span> rfArray<span class="op">.</span><span class="fu">get</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>])<span class="op">;</span> <span class="co">// False Positive</span></span>
<span id="cb2-374"><a href="#cb2-374" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> FN_rf <span class="op">=</span> rfArray<span class="op">.</span><span class="fu">get</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span> <span class="co">// False Negative</span></span>
<span id="cb2-375"><a href="#cb2-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-376"><a href="#cb2-376" aria-hidden="true" tabindex="-1"></a><span class="co">// Precision = TP / (TP + FP)</span></span>
<span id="cb2-377"><a href="#cb2-377" aria-hidden="true" tabindex="-1"></a><span class="co">// Of all areas predicted as high-risk, how many actually had landslides?</span></span>
<span id="cb2-378"><a href="#cb2-378" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> precision_rf <span class="op">=</span> TP_rf<span class="op">.</span><span class="fu">divide</span>(TP_rf<span class="op">.</span><span class="fu">add</span>(FP_rf))<span class="op">;</span></span>
<span id="cb2-379"><a href="#cb2-379" aria-hidden="true" tabindex="-1"></a><span class="co">// Recall = TP / (TP + FN)</span></span>
<span id="cb2-380"><a href="#cb2-380" aria-hidden="true" tabindex="-1"></a><span class="co">// Of all actual landslides, how many were correctly predicted as high-risk?</span></span>
<span id="cb2-381"><a href="#cb2-381" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> recall_rf <span class="op">=</span> TP_rf<span class="op">.</span><span class="fu">divide</span>(TP_rf<span class="op">.</span><span class="fu">add</span>(FN_rf))<span class="op">;</span></span>
<span id="cb2-382"><a href="#cb2-382" aria-hidden="true" tabindex="-1"></a><span class="co">// F1 Score = 2 * (precision * recall) / (precision + recall)</span></span>
<span id="cb2-383"><a href="#cb2-383" aria-hidden="true" tabindex="-1"></a><span class="co">// Balances the model’s ability to avoid false positives and false negatives</span></span>
<span id="cb2-384"><a href="#cb2-384" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> f1_rf <span class="op">=</span> precision_rf<span class="op">.</span><span class="fu">multiply</span>(recall_rf)<span class="op">.</span><span class="fu">multiply</span>(<span class="dv">2</span>)<span class="op">.</span><span class="fu">divide</span>(precision_rf<span class="op">.</span><span class="fu">add</span>(recall_rf)<span class="op">.</span><span class="fu">max</span>(<span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb2-385"><a href="#cb2-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-386"><a href="#cb2-386" aria-hidden="true" tabindex="-1"></a><span class="co">// Variable Importance in RF Classifier (how useful each variable was in tree splits)</span></span>
<span id="cb2-387"><a href="#cb2-387" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> importance <span class="op">=</span> ee<span class="op">.</span><span class="fu">Dictionary</span>(classifier<span class="op">.</span><span class="fu">explain</span>()<span class="op">.</span><span class="fu">get</span>(<span class="st">'importance'</span>))<span class="op">;</span></span>
<span id="cb2-388"><a href="#cb2-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-389"><a href="#cb2-389" aria-hidden="true" tabindex="-1"></a><span class="co">// Convert variable importance dictionary to a FeatureCollection</span></span>
<span id="cb2-390"><a href="#cb2-390" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> keys <span class="op">=</span> importance<span class="op">.</span><span class="fu">keys</span>()<span class="op">;</span></span>
<span id="cb2-391"><a href="#cb2-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-392"><a href="#cb2-392" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> importanceFeatures <span class="op">=</span> keys<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(key) {</span>
<span id="cb2-393"><a href="#cb2-393" aria-hidden="true" tabindex="-1"></a>  key <span class="op">=</span> ee<span class="op">.</span><span class="fu">String</span>(key)<span class="op">;</span></span>
<span id="cb2-394"><a href="#cb2-394" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ee<span class="op">.</span><span class="fu">Feature</span>(<span class="kw">null</span><span class="op">,</span> {</span>
<span id="cb2-395"><a href="#cb2-395" aria-hidden="true" tabindex="-1"></a>    <span class="dt">variable</span><span class="op">:</span> key<span class="op">,</span></span>
<span id="cb2-396"><a href="#cb2-396" aria-hidden="true" tabindex="-1"></a>    <span class="dt">importance</span><span class="op">:</span> ee<span class="op">.</span><span class="fu">Number</span>(importance<span class="op">.</span><span class="fu">get</span>(key))</span>
<span id="cb2-397"><a href="#cb2-397" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb2-398"><a href="#cb2-398" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-399"><a href="#cb2-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-400"><a href="#cb2-400" aria-hidden="true" tabindex="-1"></a><span class="co">// Sort features by descending importance</span></span>
<span id="cb2-401"><a href="#cb2-401" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> importanceFC <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(importanceFeatures)</span>
<span id="cb2-402"><a href="#cb2-402" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">sort</span>(<span class="st">'importance'</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb2-403"><a href="#cb2-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-404"><a href="#cb2-404" aria-hidden="true" tabindex="-1"></a><span class="co">// Build a horizontal bar chart usig the FeatureCollection</span></span>
<span id="cb2-405"><a href="#cb2-405" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">feature</span><span class="op">.</span><span class="fu">byFeature</span>(importanceFC<span class="op">,</span> <span class="st">'variable'</span><span class="op">,</span> <span class="st">'importance'</span>)</span>
<span id="cb2-406"><a href="#cb2-406" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setChartType</span>(<span class="st">'BarChart'</span>)</span>
<span id="cb2-407"><a href="#cb2-407" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb2-408"><a href="#cb2-408" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">'Random Forest Variable Importance'</span><span class="op">,</span></span>
<span id="cb2-409"><a href="#cb2-409" aria-hidden="true" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">'Importance'</span>}<span class="op">,</span> <span class="co">// x-axis: importance score</span></span>
<span id="cb2-410"><a href="#cb2-410" aria-hidden="true" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">'Variable'</span>}<span class="op">,</span> <span class="co">// y-axis: variable names</span></span>
<span id="cb2-411"><a href="#cb2-411" aria-hidden="true" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> <span class="st">'none'</span><span class="op">,</span></span>
<span id="cb2-412"><a href="#cb2-412" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">12</span></span>
<span id="cb2-413"><a href="#cb2-413" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb2-414"><a href="#cb2-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-415"><a href="#cb2-415" aria-hidden="true" tabindex="-1"></a><span class="co">// ---------------------------------------------------------------------------------------------------</span></span>
<span id="cb2-416"><a href="#cb2-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-417"><a href="#cb2-417" aria-hidden="true" tabindex="-1"></a><span class="co">// Model Verification for Populated Areas Only (on damaged landslide points in populated areas) - Added 29/04/2025</span></span>
<span id="cb2-418"><a href="#cb2-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-419"><a href="#cb2-419" aria-hidden="true" tabindex="-1"></a><span class="co">// 1. Filter damaged landslides to only populated areas</span></span>
<span id="cb2-420"><a href="#cb2-420" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> populatedMask <span class="op">=</span> popBinary<span class="op">.</span><span class="fu">selfMask</span>()<span class="op">;</span>  <span class="co">// mask for populated pixels</span></span>
<span id="cb2-421"><a href="#cb2-421" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> landslideInPopulated <span class="op">=</span> landslidePoints<span class="op">.</span><span class="fu">filterBounds</span>(populatedMask<span class="op">.</span><span class="fu">geometry</span>())<span class="op">;</span></span>
<span id="cb2-422"><a href="#cb2-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-423"><a href="#cb2-423" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> filteredPoints <span class="op">=</span> popBinary<span class="op">.</span><span class="fu">reduceRegions</span>({</span>
<span id="cb2-424"><a href="#cb2-424" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> landslideInPopulated<span class="op">,</span></span>
<span id="cb2-425"><a href="#cb2-425" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">first</span>()<span class="op">,</span></span>
<span id="cb2-426"><a href="#cb2-426" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">1000</span></span>
<span id="cb2-427"><a href="#cb2-427" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">'first'</span><span class="op">,</span> <span class="dv">1</span>))<span class="op">;</span>  <span class="co">// keep only if pixel itself is populated</span></span>
<span id="cb2-428"><a href="#cb2-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-429"><a href="#cb2-429" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(filteredPoints<span class="op">,</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">'purple'</span><span class="op">,</span> <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">5</span>}<span class="op">,</span> <span class="st">'Landslides Points (Populated Areas)'</span>)<span class="op">;</span></span>
<span id="cb2-430"><a href="#cb2-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-431"><a href="#cb2-431" aria-hidden="true" tabindex="-1"></a><span class="co">// 2. Sample susceptibility risk at those landslide points (in populated areas)</span></span>
<span id="cb2-432"><a href="#cb2-432" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> populatedValidationSamples <span class="op">=</span> normalizedPopulatedRisk<span class="op">.</span><span class="fu">sampleRegions</span>({</span>
<span id="cb2-433"><a href="#cb2-433" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> filteredPoints<span class="op">,</span></span>
<span id="cb2-434"><a href="#cb2-434" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">1000</span><span class="op">,</span></span>
<span id="cb2-435"><a href="#cb2-435" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometries</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb2-436"><a href="#cb2-436" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">neq</span>(<span class="st">'risk'</span><span class="op">,</span> <span class="kw">null</span>))<span class="op">;</span></span>
<span id="cb2-437"><a href="#cb2-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-438"><a href="#cb2-438" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> populatedPointRiskCounts <span class="op">=</span> populatedValidationSamples<span class="op">.</span><span class="fu">reduceColumns</span>({</span>
<span id="cb2-439"><a href="#cb2-439" aria-hidden="true" tabindex="-1"></a>  <span class="dt">selectors</span><span class="op">:</span> [<span class="st">'risk'</span>]<span class="op">,</span></span>
<span id="cb2-440"><a href="#cb2-440" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">histogram</span>()</span>
<span id="cb2-441"><a href="#cb2-441" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-442"><a href="#cb2-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-443"><a href="#cb2-443" aria-hidden="true" tabindex="-1"></a><span class="co">// 3. Compute population-specific percentiles</span></span>
<span id="cb2-444"><a href="#cb2-444" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> populatedRiskPercentiles <span class="op">=</span> normalizedPopulatedRisk<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb2-445"><a href="#cb2-445" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">percentile</span>([<span class="dv">33</span><span class="op">,</span> <span class="dv">66</span>])<span class="op">,</span></span>
<span id="cb2-446"><a href="#cb2-446" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometry</span><span class="op">:</span> NepalBoundary<span class="op">.</span><span class="fu">geometry</span>()<span class="op">,</span></span>
<span id="cb2-447"><a href="#cb2-447" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">1000</span><span class="op">,</span></span>
<span id="cb2-448"><a href="#cb2-448" aria-hidden="true" tabindex="-1"></a>  <span class="dt">bestEffort</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb2-449"><a href="#cb2-449" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-450"><a href="#cb2-450" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> p33Pop <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(populatedRiskPercentiles<span class="op">.</span><span class="fu">get</span>(<span class="st">'risk_p33'</span>))<span class="op">;</span></span>
<span id="cb2-451"><a href="#cb2-451" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> p66Pop <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(populatedRiskPercentiles<span class="op">.</span><span class="fu">get</span>(<span class="st">'risk_p66'</span>))<span class="op">;</span></span>
<span id="cb2-452"><a href="#cb2-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-453"><a href="#cb2-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-454"><a href="#cb2-454" aria-hidden="true" tabindex="-1"></a><span class="co">// 4. Reclassify risk map into zones (1 = low, 2 = medium, 3 = high)</span></span>
<span id="cb2-455"><a href="#cb2-455" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> populatedSusceptibilityZones <span class="op">=</span> normalizedPopulatedRisk</span>
<span id="cb2-456"><a href="#cb2-456" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">where</span>(normalizedPopulatedRisk<span class="op">.</span><span class="fu">lt</span>(p33Pop)<span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb2-457"><a href="#cb2-457" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">where</span>(normalizedPopulatedRisk<span class="op">.</span><span class="fu">gte</span>(p33Pop)<span class="op">.</span><span class="fu">and</span>(normalizedPopulatedRisk<span class="op">.</span><span class="fu">lt</span>(p66Pop))<span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb2-458"><a href="#cb2-458" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">where</span>(normalizedPopulatedRisk<span class="op">.</span><span class="fu">gte</span>(p66Pop)<span class="op">,</span> <span class="dv">3</span>)</span>
<span id="cb2-459"><a href="#cb2-459" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">rename</span>(<span class="st">'zone'</span>)</span>
<span id="cb2-460"><a href="#cb2-460" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">updateMask</span>(normalizedPopulatedRisk<span class="op">.</span><span class="fu">mask</span>())</span>
<span id="cb2-461"><a href="#cb2-461" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">clip</span>(NepalBoundary)<span class="op">;</span></span>
<span id="cb2-462"><a href="#cb2-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-463"><a href="#cb2-463" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(populatedSusceptibilityZones<span class="op">,</span> {<span class="dt">min</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> [<span class="st">'green'</span><span class="op">,</span> <span class="st">'yellow'</span><span class="op">,</span> <span class="st">'red'</span>]}<span class="op">,</span> <span class="st">'Populated Susceptibility Zones'</span><span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb2-464"><a href="#cb2-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-465"><a href="#cb2-465" aria-hidden="true" tabindex="-1"></a><span class="co">// 5. Sample zones at landslide points</span></span>
<span id="cb2-466"><a href="#cb2-466" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> populatedValidationZones <span class="op">=</span> populatedSusceptibilityZones<span class="op">.</span><span class="fu">sampleRegions</span>({</span>
<span id="cb2-467"><a href="#cb2-467" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> filteredPoints<span class="op">,</span></span>
<span id="cb2-468"><a href="#cb2-468" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">1000</span><span class="op">,</span></span>
<span id="cb2-469"><a href="#cb2-469" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometries</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb2-470"><a href="#cb2-470" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">neq</span>(<span class="st">'zone'</span><span class="op">,</span> <span class="kw">null</span>))<span class="op">;</span></span>
<span id="cb2-471"><a href="#cb2-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-472"><a href="#cb2-472" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> populatedPointCounts <span class="op">=</span> populatedValidationZones<span class="op">.</span><span class="fu">reduceColumns</span>({</span>
<span id="cb2-473"><a href="#cb2-473" aria-hidden="true" tabindex="-1"></a>  <span class="dt">selectors</span><span class="op">:</span> [<span class="st">'zone'</span>]<span class="op">,</span></span>
<span id="cb2-474"><a href="#cb2-474" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">frequencyHistogram</span>()</span>
<span id="cb2-475"><a href="#cb2-475" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-476"><a href="#cb2-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-477"><a href="#cb2-477" aria-hidden="true" tabindex="-1"></a><span class="co">// 6. Generate random points in Nepal and retain only those in populated pixels</span></span>
<span id="cb2-478"><a href="#cb2-478" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> randomPopulatedPoints <span class="op">=</span> ee<span class="op">.</span><span class="at">FeatureCollection</span><span class="op">.</span><span class="fu">randomPoints</span>({</span>
<span id="cb2-479"><a href="#cb2-479" aria-hidden="true" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> NepalBoundary<span class="op">.</span><span class="fu">geometry</span>()<span class="op">,</span></span>
<span id="cb2-480"><a href="#cb2-480" aria-hidden="true" tabindex="-1"></a>  <span class="dt">points</span><span class="op">:</span> filteredPoints<span class="op">.</span><span class="fu">size</span>()<span class="op">,</span></span>
<span id="cb2-481"><a href="#cb2-481" aria-hidden="true" tabindex="-1"></a>  <span class="dt">seed</span><span class="op">:</span> <span class="dv">42</span><span class="op">,</span></span>
<span id="cb2-482"><a href="#cb2-482" aria-hidden="true" tabindex="-1"></a>  <span class="dt">maxError</span><span class="op">:</span> <span class="dv">1</span></span>
<span id="cb2-483"><a href="#cb2-483" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="fu">filterBounds</span>(popBinary<span class="op">.</span><span class="fu">geometry</span>())<span class="op">;</span></span>
<span id="cb2-484"><a href="#cb2-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-485"><a href="#cb2-485" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> randomPopulatedSamples <span class="op">=</span> populatedSusceptibilityZones<span class="op">.</span><span class="fu">sampleRegions</span>({</span>
<span id="cb2-486"><a href="#cb2-486" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> randomPopulatedPoints<span class="op">,</span></span>
<span id="cb2-487"><a href="#cb2-487" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">1000</span><span class="op">,</span></span>
<span id="cb2-488"><a href="#cb2-488" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometries</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb2-489"><a href="#cb2-489" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">neq</span>(<span class="st">'zone'</span><span class="op">,</span> <span class="kw">null</span>))<span class="op">;</span></span>
<span id="cb2-490"><a href="#cb2-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-491"><a href="#cb2-491" aria-hidden="true" tabindex="-1"></a><span class="co">// 7. Frequency histogram comparison</span></span>
<span id="cb2-492"><a href="#cb2-492" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> realPopulatedCounts <span class="op">=</span> populatedValidationZones<span class="op">.</span><span class="fu">reduceColumns</span>({</span>
<span id="cb2-493"><a href="#cb2-493" aria-hidden="true" tabindex="-1"></a>  <span class="dt">selectors</span><span class="op">:</span> [<span class="st">'zone'</span>]<span class="op">,</span></span>
<span id="cb2-494"><a href="#cb2-494" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">frequencyHistogram</span>()</span>
<span id="cb2-495"><a href="#cb2-495" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-496"><a href="#cb2-496" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> randomPopulatedCounts <span class="op">=</span> randomPopulatedSamples<span class="op">.</span><span class="fu">reduceColumns</span>({</span>
<span id="cb2-497"><a href="#cb2-497" aria-hidden="true" tabindex="-1"></a>  <span class="dt">selectors</span><span class="op">:</span> [<span class="st">'zone'</span>]<span class="op">,</span></span>
<span id="cb2-498"><a href="#cb2-498" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">frequencyHistogram</span>()</span>
<span id="cb2-499"><a href="#cb2-499" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-500"><a href="#cb2-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-501"><a href="#cb2-501" aria-hidden="true" tabindex="-1"></a><span class="co">// 8. Chi-Square test: real vs random distribution</span></span>
<span id="cb2-502"><a href="#cb2-502" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> realPopDict <span class="op">=</span> ee<span class="op">.</span><span class="fu">Dictionary</span>(realPopulatedCounts<span class="op">.</span><span class="fu">get</span>(<span class="st">'histogram'</span>))<span class="op">;</span></span>
<span id="cb2-503"><a href="#cb2-503" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> randomPopDict <span class="op">=</span> ee<span class="op">.</span><span class="fu">Dictionary</span>(randomPopulatedCounts<span class="op">.</span><span class="fu">get</span>(<span class="st">'histogram'</span>))<span class="op">;</span></span>
<span id="cb2-504"><a href="#cb2-504" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> keysPop <span class="op">=</span> realPopDict<span class="op">.</span><span class="fu">keys</span>()<span class="op">;</span></span>
<span id="cb2-505"><a href="#cb2-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-506"><a href="#cb2-506" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> chiSquarePop <span class="op">=</span> keysPop<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(key) {</span>
<span id="cb2-507"><a href="#cb2-507" aria-hidden="true" tabindex="-1"></a>  key <span class="op">=</span> ee<span class="op">.</span><span class="fu">String</span>(key)<span class="op">;</span></span>
<span id="cb2-508"><a href="#cb2-508" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> observed <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(realPopDict<span class="op">.</span><span class="fu">get</span>(key))<span class="op">;</span></span>
<span id="cb2-509"><a href="#cb2-509" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> expected <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(randomPopDict<span class="op">.</span><span class="fu">get</span>(key))<span class="op">.</span><span class="fu">max</span>(<span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb2-510"><a href="#cb2-510" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> observed<span class="op">.</span><span class="fu">subtract</span>(expected)<span class="op">.</span><span class="fu">pow</span>(<span class="dv">2</span>)<span class="op">.</span><span class="fu">divide</span>(expected)<span class="op">;</span></span>
<span id="cb2-511"><a href="#cb2-511" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-512"><a href="#cb2-512" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> chiSquareTotalPop <span class="op">=</span> chiSquarePop<span class="op">.</span><span class="fu">reduce</span>(ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">sum</span>())<span class="op">;</span></span>
<span id="cb2-513"><a href="#cb2-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-514"><a href="#cb2-514" aria-hidden="true" tabindex="-1"></a><span class="co">// Binary Evaluation for Populated Areas Only</span></span>
<span id="cb2-515"><a href="#cb2-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-516"><a href="#cb2-516" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> populatedRealLabeled <span class="op">=</span> populatedSusceptibilityZones<span class="op">.</span><span class="fu">sampleRegions</span>({</span>
<span id="cb2-517"><a href="#cb2-517" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> filteredPoints<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(f) {</span>
<span id="cb2-518"><a href="#cb2-518" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> f<span class="op">.</span><span class="fu">set</span>(<span class="st">'label'</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb2-519"><a href="#cb2-519" aria-hidden="true" tabindex="-1"></a>  })<span class="op">,</span></span>
<span id="cb2-520"><a href="#cb2-520" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">1000</span><span class="op">,</span></span>
<span id="cb2-521"><a href="#cb2-521" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometries</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb2-522"><a href="#cb2-522" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">neq</span>(<span class="st">'zone'</span><span class="op">,</span> <span class="kw">null</span>))<span class="op">;</span></span>
<span id="cb2-523"><a href="#cb2-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-524"><a href="#cb2-524" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> populatedRandomLabeled <span class="op">=</span> populatedSusceptibilityZones<span class="op">.</span><span class="fu">sampleRegions</span>({</span>
<span id="cb2-525"><a href="#cb2-525" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> randomPopulatedPoints<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(f) {</span>
<span id="cb2-526"><a href="#cb2-526" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> f<span class="op">.</span><span class="fu">set</span>(<span class="st">'label'</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb2-527"><a href="#cb2-527" aria-hidden="true" tabindex="-1"></a>  })<span class="op">,</span></span>
<span id="cb2-528"><a href="#cb2-528" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">1000</span><span class="op">,</span></span>
<span id="cb2-529"><a href="#cb2-529" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometries</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb2-530"><a href="#cb2-530" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">neq</span>(<span class="st">'zone'</span><span class="op">,</span> <span class="kw">null</span>))<span class="op">;</span></span>
<span id="cb2-531"><a href="#cb2-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-532"><a href="#cb2-532" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> populatedAllPoints <span class="op">=</span> populatedRealLabeled<span class="op">.</span><span class="fu">merge</span>(populatedRandomLabeled)<span class="op">;</span></span>
<span id="cb2-533"><a href="#cb2-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-534"><a href="#cb2-534" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> populatedPredictions <span class="op">=</span> populatedAllPoints<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(f) {</span>
<span id="cb2-535"><a href="#cb2-535" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> zone <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(f<span class="op">.</span><span class="fu">get</span>(<span class="st">'zone'</span>))<span class="op">;</span></span>
<span id="cb2-536"><a href="#cb2-536" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> predicted <span class="op">=</span> zone<span class="op">.</span><span class="fu">eq</span>(<span class="dv">3</span>)<span class="op">;</span>  <span class="co">// high risk</span></span>
<span id="cb2-537"><a href="#cb2-537" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> f<span class="op">.</span><span class="fu">set</span>(<span class="st">'predicted'</span><span class="op">,</span> predicted)<span class="op">;</span></span>
<span id="cb2-538"><a href="#cb2-538" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-539"><a href="#cb2-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-540"><a href="#cb2-540" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> populatedConfusion <span class="op">=</span> populatedPredictions<span class="op">.</span><span class="fu">errorMatrix</span>(<span class="st">'label'</span><span class="op">,</span> <span class="st">'predicted'</span>)<span class="op">;</span></span>
<span id="cb2-541"><a href="#cb2-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-542"><a href="#cb2-542" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> cmArrayPop <span class="op">=</span> ee<span class="op">.</span><span class="fu">Array</span>(populatedConfusion<span class="op">.</span><span class="fu">array</span>())<span class="op">;</span></span>
<span id="cb2-543"><a href="#cb2-543" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> TP_pop <span class="op">=</span> cmArrayPop<span class="op">.</span><span class="fu">get</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>])<span class="op">;</span></span>
<span id="cb2-544"><a href="#cb2-544" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> FP_pop <span class="op">=</span> cmArrayPop<span class="op">.</span><span class="fu">get</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>])<span class="op">;</span></span>
<span id="cb2-545"><a href="#cb2-545" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> FN_pop <span class="op">=</span> cmArrayPop<span class="op">.</span><span class="fu">get</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb2-546"><a href="#cb2-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-547"><a href="#cb2-547" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> precisionPop <span class="op">=</span> TP_pop<span class="op">.</span><span class="fu">divide</span>(TP_pop<span class="op">.</span><span class="fu">add</span>(FP_pop))<span class="op">;</span></span>
<span id="cb2-548"><a href="#cb2-548" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> recallPop <span class="op">=</span> TP_pop<span class="op">.</span><span class="fu">divide</span>(TP_pop<span class="op">.</span><span class="fu">add</span>(FN_pop))<span class="op">;</span></span>
<span id="cb2-549"><a href="#cb2-549" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> f1Pop <span class="op">=</span> precisionPop<span class="op">.</span><span class="fu">multiply</span>(recallPop)<span class="op">.</span><span class="fu">multiply</span>(<span class="dv">2</span>)<span class="op">.</span><span class="fu">divide</span>(precisionPop<span class="op">.</span><span class="fu">add</span>(recallPop)<span class="op">.</span><span class="fu">max</span>(<span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb2-550"><a href="#cb2-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-551"><a href="#cb2-551" aria-hidden="true" tabindex="-1"></a><span class="co">// Model Comparison Summary:</span></span>
<span id="cb2-552"><a href="#cb2-552" aria-hidden="true" tabindex="-1"></a><span class="co">// - Chi-square value more than tripled (804.6 → 2562.9), indicating a much stronger statistical association between predicted high-risk zones and actual landslides occurring in populated areas.</span></span>
<span id="cb2-553"><a href="#cb2-553" aria-hidden="true" tabindex="-1"></a><span class="co">// - Precision significantly improved (0.600 → 0.729), meaning the model's high-risk predictions are more trustworthy where people live.</span></span>
<span id="cb2-554"><a href="#cb2-554" aria-hidden="true" tabindex="-1"></a><span class="co">// - Recall declined (0.504 → 0.480), indicating that a portion of actual landslides in populated areas still fall outside the predicted high-risk zone.</span></span>
<span id="cb2-555"><a href="#cb2-555" aria-hidden="true" tabindex="-1"></a><span class="co">// - F1 Score increased (0.548 → 0.579), reflecting better overall balance between precision and recall.</span></span>
<span id="cb2-556"><a href="#cb2-556" aria-hidden="true" tabindex="-1"></a><span class="co">// - Accuracy slightly declined (0.581 → 0.537), which is expected as unpopulated, low-risk areas (which are easy to classify) are excluded.</span></span>
<span id="cb2-557"><a href="#cb2-557" aria-hidden="true" tabindex="-1"></a><span class="co">// Limiting evaluation to populated areas enhances the model’s relevance and precision for human-impact zones</span></span>
<span id="cb2-558"><a href="#cb2-558" aria-hidden="true" tabindex="-1"></a><span class="co">// even if some events remain harder to capture. This prioritises decision-making where exposure is highest.</span></span>
<span id="cb2-559"><a href="#cb2-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-560"><a href="#cb2-560" aria-hidden="true" tabindex="-1"></a><span class="co">// Random Forest Classifier (Populated Areas Only)</span></span>
<span id="cb2-561"><a href="#cb2-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-562"><a href="#cb2-562" aria-hidden="true" tabindex="-1"></a><span class="co">// 1. Label landslide points</span></span>
<span id="cb2-563"><a href="#cb2-563" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> populatedLandslidePoints <span class="op">=</span> filteredPoints<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(f) {</span>
<span id="cb2-564"><a href="#cb2-564" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> f<span class="op">.</span><span class="fu">set</span>(<span class="st">'class'</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb2-565"><a href="#cb2-565" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-566"><a href="#cb2-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-567"><a href="#cb2-567" aria-hidden="true" tabindex="-1"></a><span class="co">// 2. Compute oversample factor based on area</span></span>
<span id="cb2-568"><a href="#cb2-568" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> nepalArea <span class="op">=</span> NepalBoundary<span class="op">.</span><span class="fu">geometry</span>()<span class="op">.</span><span class="fu">area</span>()<span class="op">.</span><span class="fu">divide</span>(<span class="fl">1e6</span>)<span class="op">;</span>  <span class="co">// in km²</span></span>
<span id="cb2-569"><a href="#cb2-569" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> populatedPixelCount <span class="op">=</span> popBinary<span class="op">.</span><span class="fu">selfMask</span>()<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb2-570"><a href="#cb2-570" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">sum</span>()<span class="op">,</span></span>
<span id="cb2-571"><a href="#cb2-571" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometry</span><span class="op">:</span> NepalBoundary<span class="op">.</span><span class="fu">geometry</span>()<span class="op">,</span></span>
<span id="cb2-572"><a href="#cb2-572" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">1000</span><span class="op">,</span></span>
<span id="cb2-573"><a href="#cb2-573" aria-hidden="true" tabindex="-1"></a>  <span class="dt">maxPixels</span><span class="op">:</span> <span class="fl">1e13</span></span>
<span id="cb2-574"><a href="#cb2-574" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="fu">get</span>(<span class="st">'popBinary'</span>)<span class="op">;</span></span>
<span id="cb2-575"><a href="#cb2-575" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> populatedArea <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(populatedPixelCount)<span class="op">;</span>  <span class="co">// each pixel ~ 1 km²</span></span>
<span id="cb2-576"><a href="#cb2-576" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> oversampleFactor <span class="op">=</span> nepalArea<span class="op">.</span><span class="fu">divide</span>(populatedArea)<span class="op">.</span><span class="fu">ceil</span>()<span class="op">;</span></span>
<span id="cb2-577"><a href="#cb2-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-578"><a href="#cb2-578" aria-hidden="true" tabindex="-1"></a><span class="co">// 3. Generate oversampled random points and mask to populated areas</span></span>
<span id="cb2-579"><a href="#cb2-579" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> oversampledPoints <span class="op">=</span> ee<span class="op">.</span><span class="at">FeatureCollection</span><span class="op">.</span><span class="fu">randomPoints</span>({</span>
<span id="cb2-580"><a href="#cb2-580" aria-hidden="true" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> NepalBoundary<span class="op">.</span><span class="fu">geometry</span>()<span class="op">,</span></span>
<span id="cb2-581"><a href="#cb2-581" aria-hidden="true" tabindex="-1"></a>  <span class="dt">points</span><span class="op">:</span> populatedLandslidePoints<span class="op">.</span><span class="fu">size</span>()<span class="op">.</span><span class="fu">multiply</span>(oversampleFactor)<span class="op">.</span><span class="fu">int</span>()<span class="op">,</span></span>
<span id="cb2-582"><a href="#cb2-582" aria-hidden="true" tabindex="-1"></a>  <span class="dt">seed</span><span class="op">:</span> <span class="dv">42</span><span class="op">,</span></span>
<span id="cb2-583"><a href="#cb2-583" aria-hidden="true" tabindex="-1"></a>  <span class="dt">maxError</span><span class="op">:</span> <span class="dv">1</span></span>
<span id="cb2-584"><a href="#cb2-584" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-585"><a href="#cb2-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-586"><a href="#cb2-586" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> randomPopulatedPoints <span class="op">=</span> popBinary<span class="op">.</span><span class="fu">reduceRegions</span>({</span>
<span id="cb2-587"><a href="#cb2-587" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> oversampledPoints<span class="op">,</span></span>
<span id="cb2-588"><a href="#cb2-588" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">first</span>()<span class="op">,</span></span>
<span id="cb2-589"><a href="#cb2-589" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">1000</span></span>
<span id="cb2-590"><a href="#cb2-590" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">'first'</span><span class="op">,</span> <span class="dv">1</span>))</span>
<span id="cb2-591"><a href="#cb2-591" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">limit</span>(populatedLandslidePoints<span class="op">.</span><span class="fu">size</span>())</span>
<span id="cb2-592"><a href="#cb2-592" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(f) {</span>
<span id="cb2-593"><a href="#cb2-593" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> f<span class="op">.</span><span class="fu">set</span>(<span class="st">'class'</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb2-594"><a href="#cb2-594" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb2-595"><a href="#cb2-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-596"><a href="#cb2-596" aria-hidden="true" tabindex="-1"></a><span class="co">// 4. Visual confirmation</span></span>
<span id="cb2-597"><a href="#cb2-597" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(populatedLandslidePoints<span class="op">,</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">'red'</span>}<span class="op">,</span> <span class="st">'Populated Landslide Points'</span>)<span class="op">;</span></span>
<span id="cb2-598"><a href="#cb2-598" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(randomPopulatedPoints<span class="op">,</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">'blue'</span>}<span class="op">,</span> <span class="st">'Random Points in Populated Areas'</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb2-599"><a href="#cb2-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-600"><a href="#cb2-600" aria-hidden="true" tabindex="-1"></a><span class="co">// 5. Training data and feature stack</span></span>
<span id="cb2-601"><a href="#cb2-601" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trainingPointsPopulated <span class="op">=</span> populatedLandslidePoints<span class="op">.</span><span class="fu">merge</span>(randomPopulatedPoints)<span class="op">;</span></span>
<span id="cb2-602"><a href="#cb2-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-603"><a href="#cb2-603" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> featuresImagePopulated <span class="op">=</span> ee<span class="op">.</span><span class="at">Image</span><span class="op">.</span><span class="fu">cat</span>([</span>
<span id="cb2-604"><a href="#cb2-604" aria-hidden="true" tabindex="-1"></a>  normSlope<span class="op">,</span></span>
<span id="cb2-605"><a href="#cb2-605" aria-hidden="true" tabindex="-1"></a>  normalizedDrainageDensity<span class="op">,</span></span>
<span id="cb2-606"><a href="#cb2-606" aria-hidden="true" tabindex="-1"></a>  normElev<span class="op">,</span></span>
<span id="cb2-607"><a href="#cb2-607" aria-hidden="true" tabindex="-1"></a>  normClay<span class="op">,</span></span>
<span id="cb2-608"><a href="#cb2-608" aria-hidden="true" tabindex="-1"></a>  reclassifiedLand<span class="op">,</span></span>
<span id="cb2-609"><a href="#cb2-609" aria-hidden="true" tabindex="-1"></a>  normalizedSoilTexture</span>
<span id="cb2-610"><a href="#cb2-610" aria-hidden="true" tabindex="-1"></a>])<span class="op">.</span><span class="fu">rename</span>([</span>
<span id="cb2-611"><a href="#cb2-611" aria-hidden="true" tabindex="-1"></a>  <span class="st">'slope'</span><span class="op">,</span> <span class="st">'drainDen'</span><span class="op">,</span> <span class="st">'elev'</span><span class="op">,</span> <span class="st">'clay'</span><span class="op">,</span> <span class="st">'landcover'</span><span class="op">,</span> <span class="st">'soiltex'</span></span>
<span id="cb2-612"><a href="#cb2-612" aria-hidden="true" tabindex="-1"></a>])<span class="op">.</span><span class="fu">updateMask</span>(popBinary)<span class="op">;</span></span>
<span id="cb2-613"><a href="#cb2-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-614"><a href="#cb2-614" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trainingPopulated <span class="op">=</span> featuresImagePopulated<span class="op">.</span><span class="fu">sampleRegions</span>({</span>
<span id="cb2-615"><a href="#cb2-615" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> trainingPointsPopulated<span class="op">,</span></span>
<span id="cb2-616"><a href="#cb2-616" aria-hidden="true" tabindex="-1"></a>  <span class="dt">properties</span><span class="op">:</span> [<span class="st">'class'</span>]<span class="op">,</span></span>
<span id="cb2-617"><a href="#cb2-617" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">1000</span><span class="op">,</span></span>
<span id="cb2-618"><a href="#cb2-618" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometries</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb2-619"><a href="#cb2-619" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-620"><a href="#cb2-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-621"><a href="#cb2-621" aria-hidden="true" tabindex="-1"></a><span class="co">// 6. Train/test split</span></span>
<span id="cb2-622"><a href="#cb2-622" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> withRandom <span class="op">=</span> trainingPopulated<span class="op">.</span><span class="fu">randomColumn</span>(<span class="st">'random'</span>)<span class="op">;</span></span>
<span id="cb2-623"><a href="#cb2-623" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trainSetPop <span class="op">=</span> withRandom<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">lt</span>(<span class="st">'random'</span><span class="op">,</span> <span class="fl">0.7</span>))<span class="op">;</span></span>
<span id="cb2-624"><a href="#cb2-624" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> valSetPop <span class="op">=</span> withRandom<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">gte</span>(<span class="st">'random'</span><span class="op">,</span> <span class="fl">0.7</span>))<span class="op">;</span></span>
<span id="cb2-625"><a href="#cb2-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-626"><a href="#cb2-626" aria-hidden="true" tabindex="-1"></a><span class="co">// 7. Train Random Forest model</span></span>
<span id="cb2-627"><a href="#cb2-627" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> rfClassifierPop <span class="op">=</span> ee<span class="op">.</span><span class="at">Classifier</span><span class="op">.</span><span class="fu">smileRandomForest</span>(<span class="dv">50</span>)<span class="op">.</span><span class="fu">train</span>({</span>
<span id="cb2-628"><a href="#cb2-628" aria-hidden="true" tabindex="-1"></a>  <span class="dt">features</span><span class="op">:</span> trainSetPop<span class="op">,</span></span>
<span id="cb2-629"><a href="#cb2-629" aria-hidden="true" tabindex="-1"></a>  <span class="dt">classProperty</span><span class="op">:</span> <span class="st">'class'</span><span class="op">,</span></span>
<span id="cb2-630"><a href="#cb2-630" aria-hidden="true" tabindex="-1"></a>  <span class="dt">inputProperties</span><span class="op">:</span> [<span class="st">'slope'</span><span class="op">,</span> <span class="st">'drainDen'</span><span class="op">,</span> <span class="st">'elev'</span><span class="op">,</span> <span class="st">'clay'</span><span class="op">,</span> <span class="st">'landcover'</span><span class="op">,</span> <span class="st">'soiltex'</span>]</span>
<span id="cb2-631"><a href="#cb2-631" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-632"><a href="#cb2-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-633"><a href="#cb2-633" aria-hidden="true" tabindex="-1"></a><span class="co">// 8. Evaluate on validation set</span></span>
<span id="cb2-634"><a href="#cb2-634" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> validatedPop <span class="op">=</span> valSetPop</span>
<span id="cb2-635"><a href="#cb2-635" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">notNull</span>([<span class="st">'slope'</span><span class="op">,</span> <span class="st">'drainDen'</span><span class="op">,</span> <span class="st">'elev'</span><span class="op">,</span> <span class="st">'clay'</span><span class="op">,</span> <span class="st">'landcover'</span><span class="op">,</span> <span class="st">'soiltex'</span>]))</span>
<span id="cb2-636"><a href="#cb2-636" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">classify</span>(rfClassifierPop)<span class="op">;</span></span>
<span id="cb2-637"><a href="#cb2-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-638"><a href="#cb2-638" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> rfMatrixPop <span class="op">=</span> validatedPop<span class="op">.</span><span class="fu">errorMatrix</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'classification'</span>)<span class="op">;</span></span>
<span id="cb2-639"><a href="#cb2-639" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> rfArrayPop <span class="op">=</span> ee<span class="op">.</span><span class="fu">Array</span>(rfMatrixPop<span class="op">.</span><span class="fu">array</span>())<span class="op">;</span></span>
<span id="cb2-640"><a href="#cb2-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-641"><a href="#cb2-641" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> TP_rfPop <span class="op">=</span> rfArrayPop<span class="op">.</span><span class="fu">get</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>])<span class="op">;</span></span>
<span id="cb2-642"><a href="#cb2-642" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> FP_rfPop <span class="op">=</span> rfArrayPop<span class="op">.</span><span class="fu">get</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>])<span class="op">;</span></span>
<span id="cb2-643"><a href="#cb2-643" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> FN_rfPop <span class="op">=</span> rfArrayPop<span class="op">.</span><span class="fu">get</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb2-644"><a href="#cb2-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-645"><a href="#cb2-645" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> precision_rfPop <span class="op">=</span> TP_rfPop<span class="op">.</span><span class="fu">divide</span>(TP_rfPop<span class="op">.</span><span class="fu">add</span>(FP_rfPop))<span class="op">;</span></span>
<span id="cb2-646"><a href="#cb2-646" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> recall_rfPop <span class="op">=</span> TP_rfPop<span class="op">.</span><span class="fu">divide</span>(TP_rfPop<span class="op">.</span><span class="fu">add</span>(FN_rfPop))<span class="op">;</span></span>
<span id="cb2-647"><a href="#cb2-647" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> f1_rfPop <span class="op">=</span> precision_rfPop<span class="op">.</span><span class="fu">multiply</span>(recall_rfPop)<span class="op">.</span><span class="fu">multiply</span>(<span class="dv">2</span>)<span class="op">.</span><span class="fu">divide</span>(precision_rfPop<span class="op">.</span><span class="fu">add</span>(recall_rfPop)<span class="op">.</span><span class="fu">max</span>(<span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb2-648"><a href="#cb2-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-649"><a href="#cb2-649" aria-hidden="true" tabindex="-1"></a><span class="co">// 9. Apply classifier to image</span></span>
<span id="cb2-650"><a href="#cb2-650" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> classifiedPopulated <span class="op">=</span> featuresImagePopulated<span class="op">.</span><span class="fu">classify</span>(rfClassifierPop)<span class="op">;</span></span>
<span id="cb2-651"><a href="#cb2-651" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(classifiedPopulated<span class="op">,</span> {<span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> [<span class="st">'white'</span><span class="op">,</span> <span class="st">'red'</span>]}<span class="op">,</span> <span class="st">'RF Prediction (Populated Areas)'</span>)<span class="op">;</span></span>
<span id="cb2-652"><a href="#cb2-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-653"><a href="#cb2-653" aria-hidden="true" tabindex="-1"></a><span class="co">// 10. Generate probability surface</span></span>
<span id="cb2-654"><a href="#cb2-654" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> probabilityClassifierPop <span class="op">=</span> rfClassifierPop<span class="op">.</span><span class="fu">setOutputMode</span>(<span class="st">'PROBABILITY'</span>)<span class="op">;</span></span>
<span id="cb2-655"><a href="#cb2-655" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> probabilityMapPop <span class="op">=</span> featuresImagePopulated<span class="op">.</span><span class="fu">classify</span>(probabilityClassifierPop)<span class="op">;</span></span>
<span id="cb2-656"><a href="#cb2-656" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(probabilityMapPop<span class="op">,</span> {</span>
<span id="cb2-657"><a href="#cb2-657" aria-hidden="true" tabindex="-1"></a>  <span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb2-658"><a href="#cb2-658" aria-hidden="true" tabindex="-1"></a>  <span class="dt">max</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb2-659"><a href="#cb2-659" aria-hidden="true" tabindex="-1"></a>  <span class="dt">palette</span><span class="op">:</span> [<span class="st">'white'</span><span class="op">,</span> <span class="st">'yellow'</span><span class="op">,</span> <span class="st">'orange'</span><span class="op">,</span> <span class="st">'red'</span>]</span>
<span id="cb2-660"><a href="#cb2-660" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span> <span class="st">'RF Probability (Populated Areas)'</span>)<span class="op">;</span></span>
<span id="cb2-661"><a href="#cb2-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-662"><a href="#cb2-662" aria-hidden="true" tabindex="-1"></a><span class="co">// 11. Variable importance</span></span>
<span id="cb2-663"><a href="#cb2-663" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> importancePop <span class="op">=</span> ee<span class="op">.</span><span class="fu">Dictionary</span>(rfClassifierPop<span class="op">.</span><span class="fu">explain</span>()<span class="op">.</span><span class="fu">get</span>(<span class="st">'importance'</span>))<span class="op">;</span></span>
<span id="cb2-664"><a href="#cb2-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-665"><a href="#cb2-665" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> importanceFeaturesPop <span class="op">=</span> importancePop<span class="op">.</span><span class="fu">keys</span>()<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(key) {</span>
<span id="cb2-666"><a href="#cb2-666" aria-hidden="true" tabindex="-1"></a>  key <span class="op">=</span> ee<span class="op">.</span><span class="fu">String</span>(key)<span class="op">;</span></span>
<span id="cb2-667"><a href="#cb2-667" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ee<span class="op">.</span><span class="fu">Feature</span>(<span class="kw">null</span><span class="op">,</span> {</span>
<span id="cb2-668"><a href="#cb2-668" aria-hidden="true" tabindex="-1"></a>    <span class="dt">variable</span><span class="op">:</span> key<span class="op">,</span></span>
<span id="cb2-669"><a href="#cb2-669" aria-hidden="true" tabindex="-1"></a>    <span class="dt">importance</span><span class="op">:</span> ee<span class="op">.</span><span class="fu">Number</span>(importancePop<span class="op">.</span><span class="fu">get</span>(key))</span>
<span id="cb2-670"><a href="#cb2-670" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb2-671"><a href="#cb2-671" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-672"><a href="#cb2-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-673"><a href="#cb2-673" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> importanceFC <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(importanceFeaturesPop)<span class="op">.</span><span class="fu">sort</span>(<span class="st">'importance'</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb2-674"><a href="#cb2-674" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> chartPop <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">feature</span><span class="op">.</span><span class="fu">byFeature</span>(importanceFC<span class="op">,</span> <span class="st">'variable'</span><span class="op">,</span> <span class="st">'importance'</span>)</span>
<span id="cb2-675"><a href="#cb2-675" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setChartType</span>(<span class="st">'BarChart'</span>)</span>
<span id="cb2-676"><a href="#cb2-676" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb2-677"><a href="#cb2-677" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">'Variable Importance (Populated Areas)'</span><span class="op">,</span></span>
<span id="cb2-678"><a href="#cb2-678" aria-hidden="true" tabindex="-1"></a>    <span class="dt">hAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">'Importance'</span>}<span class="op">,</span></span>
<span id="cb2-679"><a href="#cb2-679" aria-hidden="true" tabindex="-1"></a>    <span class="dt">vAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">'Variable'</span>}<span class="op">,</span></span>
<span id="cb2-680"><a href="#cb2-680" aria-hidden="true" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> <span class="st">'none'</span><span class="op">,</span></span>
<span id="cb2-681"><a href="#cb2-681" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">12</span></span>
<span id="cb2-682"><a href="#cb2-682" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="interface" class="level2">
<h2 class="anchored" data-anchor-id="interface">Interface</h2>
<p>The website provides an intuitive, multilingual interface combining expertise and data into robust models, offering comparative visualizations and statistical summaries. The platform prioritizes clarity through map-based dashboards and toggleable language options to enhance accessibility and local impact.</p>
<p>As discussed in detail in Section ‘How It Works, 2. Interactive Visualization and Analysis’.</p>
<div class="columns" data-layout-align="center">
<div class="column" style="width:46%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/UI_2.png" class="img-fluid figure-img"></p>
<figcaption>District Level View</figcaption>
</figure>
</div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:46%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/UI_3.png" class="img-fluid figure-img"></p>
<figcaption>Methodology View</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="the-application" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="the-application">The Application</h2>
<section id="demo" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="demo">Demo</h3>
<p>The application runs on Google Earth Engine, allowing users to visualise landslide risk across Nepal dynamically. Users can zoom in to specific districts, interpret risk zones, and overlay incident data to validate model predictions. The tool is built for scalability and may be adapted for other regions facing similar geological threats.</p>
<div class="column-page">
<iframe src="https://ee-ajikumaraadarsh.projects.earthengine.app/view/nepallandslide" width="100%" height="800px">
</iframe>
</div>
</section>
<section id="key-features-beyond-the-demo" class="level3">
<h3 class="anchored" data-anchor-id="key-features-beyond-the-demo">Key Features Beyond the Demo</h3>
<p>While our demo showcases the app’s core functionality, several critical features work behind the scenes to enhance its performance and reliability. In this section, we highlight key capabilities implemented to optimize efficiency and ensure a seamless user experience.</p>
<div class="cell g-col-lg-6 g-col-12 g-col-md-12">
<div class="cell-output-display">
<div id="gallery-carousel" class="carousel carousel-dark slide" data-bs-ride="false" style="height: 700px; background-color: #f0f0f0; position: relative; width: 100%;">
<div class="carousel-indicators">
<button type="button" data-bs-target="#gallery-carousel" data-bs-slide-to="0" aria-label="Slide 1" class="active" aria-current="true"></button>
<button type="button" data-bs-target="#gallery-carousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
<button type="button" data-bs-target="#gallery-carousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
<button type="button" data-bs-target="#gallery-carousel" data-bs-slide-to="3" aria-label="Slide 4"></button>
<button type="button" data-bs-target="#gallery-carousel" data-bs-slide-to="4" aria-label="Slide 5"></button>
<button type="button" data-bs-target="#gallery-carousel" data-bs-slide-to="5" aria-label="Slide 6"></button>
<button type="button" data-bs-target="#gallery-carousel" data-bs-slide-to="6" aria-label="Slide 7"></button>
</div>
<div class="carousel-inner" style="height: 700px; width: 100%;">
<div class="carousel-item active" style="width: 100%; height: 100%; padding: 20px 70px; text-align: center; box-sizing: border-box;" data-bs-interval="5000">
<p class="carousel-title" style="padding: 0; color: #7b7f5f; font-size: 1.3em; font-family: 'News Cycle', 'Arial Narrow Bold', sans-serif; font-weight: bold; text-align: center; width: 100%;  margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">Multi-Language Support</p>
<p class="fw-light" style="padding: 10px 0; color: #000; font-size: 0.7em; text-align: center; width: 100%;  margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">Designed with the end user in mind, the app supports Nepal’s primary languages—Nepali (~44%), Maithili (~12%), and Bhojpuri (~6%)—ensuring accessibility for diverse users, including those with low English fluency.</p>
<div class="image-row" style="padding: 10px 0; width: 100%;  text-align: center; margin: 0 auto; box-sizing: border-box;">
<a href="">
<img src="images/App_multiLanguage.png" class="d-block" style="width: 100%;  max-height: 300px; height: auto; object-fit: contain; margin: 0 auto;">
</a>
</div>
<div class="code-row" style="padding: 10px 0; width: 100%;  text-align: center; margin: 0 auto; box-sizing: border-box;">
<div class="code-snippet" style="font-family: 'Courier New', monospace; font-size: 0.8em; background-color: #f5f5f5; padding: 8px; border-radius: 3px; width: 90%; height: 200px; overflow-y: auto; white-space: pre-wrap; text-align: left; margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">// Language selection dropdown
var languageSelect = ui.Select({
items: [
{label: 'English', value: 'English'},
{label: 'Nepali', value: 'Nepali'},
{label: 'Maithili', value: 'Maithili'},
{label: 'Bhojpuri', value: 'Bhojpuri'}
],
onChange: function(value) {
resetToNationalView();
updateLanguage(value);
}
});
/ Translation dictionary (Sample)
var LANGUAGE_TRANSLATIONS = {
'Nepali': { 'Click on the map or select from list:': 'नक्सामा क्लिक गर्नुहोस् वा सूचीबाट चयन गर्नुहोस्:' },
'Maithili': { 'Click on the map or select from list:': 'नक्शा पर क्लिक करू या सूची सँ चुनू' },
'Bhojpuri': { 'Click on the map or select from list:': 'नक्शा प क्लिक करीं या सूची से चुनीं' }
}; </div>
</div>
</div>
<div class="carousel-item" style="width: 100%; height: 100%; padding: 20px 70px; text-align: center; box-sizing: border-box;" data-bs-interval="5000">
<p class="carousel-title" style="padding: 0; color: #7b7f5f; font-size: 1.3em; font-family: 'News Cycle', 'Arial Narrow Bold', sans-serif; font-weight: bold; text-align: center; width: 100%;  margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">Efficient Caching</p>
<p class="fw-light" style="padding: 10px 0; color: #000; font-size: 0.7em; text-align: center; width: 100%;  margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">To avoid redundant computations, the app Leverages local memory for server-side calculations, ensuring responsiveness even with large datasets.</p>
<div class="image-row" style="padding: 10px 0; width: 100%;  text-align: center; margin: 0 auto; box-sizing: border-box;">
<a href="">
<img src="images/App_cashing.png" class="d-block" style="width: 100%;  max-height: 300px; height: auto; object-fit: contain; margin: 0 auto;">
</a>
</div>
<div class="code-row" style="padding: 10px 0; width: 100%;  text-align: center; margin: 0 auto; box-sizing: border-box;">
<div class="code-snippet" style="font-family: 'Courier New', monospace; font-size: 0.8em; background-color: #f5f5f5; padding: 8px; border-radius: 3px; width: 90%; height: 200px; overflow-y: auto; white-space: pre-wrap; text-align: left; margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">// Cache national statistics at startup
ee.Dictionary({
incidentCount: districtFactors.aggregate_sum('incidentCount'),
deaths: districtFactors.aggregate_sum('deaths'),
injuries: districtFactors.aggregate_sum('injuries'),
infrastructureDestroyed: districtFactors.aggregate_sum('infraDestroyed')
}).evaluate(
function(values) {
// Cached values used in national overview for quick loading
nationalStats.incidentCount = Number(values.incidentCount) || 0; // Total incidents
nationalStats.deaths = Number(values.deaths) || 0; // Total deaths
nationalStats.injuries = Number(values.injuries) || 0; // Total injuries
nationalStats.infrastructureDestroyed = Number(values.infrastructureDestroyed) || 0; // Total infrastructure damage
initializeAppAfterCaching();
}
);</div>
</div>
</div>
<div class="carousel-item" style="width: 100%; height: 100%; padding: 20px 70px; text-align: center; box-sizing: border-box;" data-bs-interval="5000">
<p class="carousel-title" style="padding: 0; color: #7b7f5f; font-size: 1.3em; font-family: 'News Cycle', 'Arial Narrow Bold', sans-serif; font-weight: bold; text-align: center; width: 100%;  margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">Robust Error Handling</p>
<p class="fw-light" style="padding: 10px 0; color: #000; font-size: 0.7em; text-align: center; width: 100%;  margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">The app handles clicks outside study areas and data issues with clear messages to keep users informed and engaged, preventing crashes and enhancing reliability.</p>
<div class="image-row" style="padding: 10px 0; width: 100%;  text-align: center; margin: 0 auto; box-sizing: border-box;">
<a href="">
<img src="images/App_outsideclick.png" class="d-block" style="width: 100%;  max-height: 300px; height: auto; object-fit: contain; margin: 0 auto;">
</a>
</div>
<div class="code-row" style="padding: 10px 0; width: 100%;  text-align: center; margin: 0 auto; box-sizing: border-box;">
<div class="code-snippet" style="font-family: 'Courier New', monospace; font-size: 0.8em; background-color: #f5f5f5; padding: 8px; border-radius: 3px; width: 90%; height: 200px; overflow-y: auto; white-space: pre-wrap; text-align: left; margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">// Handle clicks outside Nepal
NepalBoundary.geometry().contains(point).evaluate(function(isInside) {
if (!isInside) {
StatisticsPanel.clear();
var widgets = controlPanel.widgets();
if (widgets.indexOf(districtInstructionLabel) !== -1) {
widgets.remove(districtInstructionLabel);
}
if (widgets.indexOf(districtSelectPanel) !== -1) {
widgets.remove(districtSelectPanel);
}
StatisticsPanel.add(ui.Label(translate('Click outside Nepal boundary. Please select a point within Nepal.'), STYLES.SUBTITLE));
StatisticsPanel.add(ui.Button({
label: translate('Reset to National Overview'),
onClick: function() {
resetToNationalView();
},
style: { margin: '10px auto', stretch: 'horizontal', textAlign: 'center' }
}));
} });</div>
</div>
</div>
<div class="carousel-item" style="width: 100%; height: 100%; padding: 20px 70px; text-align: center; box-sizing: border-box;" data-bs-interval="5000">
<p class="carousel-title" style="padding: 0; color: #7b7f5f; font-size: 1.3em; font-family: 'News Cycle', 'Arial Narrow Bold', sans-serif; font-weight: bold; text-align: center; width: 100%;  margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">Optimal Rendering</p>
<p class="fw-light" style="padding: 10px 0; color: #000; font-size: 0.7em; text-align: center; width: 100%;  margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">The app enhances speed and user experience by clipping and rendering high-resolution raster data for the selected district only, rather than the entire country.</p>
<div class="image-row" style="padding: 10px 0; width: 100%;  text-align: center; margin: 0 auto; box-sizing: border-box;">
<a href="">
<img src="images/App_clipping.png" class="d-block" style="width: 100%;  max-height: 300px; height: auto; object-fit: contain; margin: 0 auto;">
</a>
</div>
<div class="code-row" style="padding: 10px 0; width: 100%;  text-align: center; margin: 0 auto; box-sizing: border-box;">
<div class="code-snippet" style="font-family: 'Courier New', monospace; font-size: 0.8em; background-color: #f5f5f5; padding: 8px; border-radius: 3px; width: 90%; height: 200px; overflow-y: auto; white-space: pre-wrap; text-align: left; margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">// Highlight and clip layers for the selected district
function highlightDistrict(district) {
// Simplify geometry to reduce computation
var districtGeometry = district.geometry().simplify({maxError: 100});
// Clip layers to district for efficient rendering
var clippedLandslide = landslidePoints.filterBounds(districtGeometry);
var clippedSus = LandslideSusceptibility.clip(districtGeometry);

clippedLandslideFeatures = null;
clippedLandslide.evaluate(function(features) {
clippedLandslideFeatures = features.features || [];
});

clearMapLayersExceptHighlight();
// Add clipped layers to map
var susceptibilityLayerclip = ui.Map.Layer(clippedSus, {min: 0, max: 1, palette: [STYLES.COLORS.LOW_RISK, STYLES.COLORS.MEDIUM_RISK, STYLES.COLORS.HIGH_RISK]});
Map.layers().add(susceptibilityLayerclip);
}</div>
</div>
</div>
<div class="carousel-item" style="width: 100%; height: 100%; padding: 20px 70px; text-align: center; box-sizing: border-box;" data-bs-interval="5000">
<p class="carousel-title" style="padding: 0; color: #7b7f5f; font-size: 1.3em; font-family: 'News Cycle', 'Arial Narrow Bold', sans-serif; font-weight: bold; text-align: center; width: 100%;  margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">Custom Basemaps and Streamlined Controls</p>
<p class="fw-light" style="padding: 10px 0; color: #000; font-size: 0.7em; text-align: center; width: 100%;  margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">The app enhances the user experience by customizing the basemap to focus on essential geographic data, modifying road displays (e.g., highways, arterial, and local roads) to reduce visual clutter and removing unneeded base elements like saturation. Additionally, main map controls (e.g., zoom, map type, scale, fullscreen) are hidden to provide a distraction-free interface.</p>
<div class="image-row" style="padding: 10px 0; width: 100%;  text-align: center; margin: 0 auto; box-sizing: border-box;">
<a href="">
<img src="images/App_basemap.png" class="d-block" style="width: 100%;  max-height: 300px; height: auto; object-fit: contain; margin: 0 auto;">
</a>
</div>
<div class="code-row" style="padding: 10px 0; width: 100%;  text-align: center; margin: 0 auto; box-sizing: border-box;">
<div class="code-snippet" style="font-family: 'Courier New', monospace; font-size: 0.8em; background-color: #f5f5f5; padding: 8px; border-radius: 3px; width: 90%; height: 200px; overflow-y: auto; white-space: pre-wrap; text-align: left; margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">// Customize basemap to reduce visual clutter
var roadNetwork = [
{stylers: [{saturation: -100}]}, // Desaturate basemap for focus on data layers
{featureType: 'road.highway', elementType: 'geometry.fill', stylers: [{color: '#000055'}, {weight: 0.1}]}, // Simplify highway display
{featureType: 'road.highway', elementType: 'geometry.stroke', stylers: [{color: '#000000'}, {weight: 0.1}]},
{featureType: 'road.arterial', elementType: 'geometry', stylers: [{color: '#FF0000'}, {weight: 0.1}]}, // Simplify arterial roads
{featureType: 'road.local', elementType: 'geometry', stylers: [{color: '#00FF55'}, {weight: 0.1}]} // Simplify local roads
];
Map.setOptions('roadNetwork', { roadNetwork: roadNetwork });

// Hide main map controls for a distraction-free interface
Map.setControlVisibility({
zoomControl: false, // Disable zoom control
mapTypeControl: false, // Disable map type selector
scaleControl: false, // Disable scale control
fullscreenControl: false // Disable fullscreen control
});
Map.drawingTools().setShown(false); // Hide drawing tools
</div>
</div>
</div>
<div class="carousel-item" style="width: 100%; height: 100%; padding: 20px 70px; text-align: center; box-sizing: border-box;" data-bs-interval="5000">
<p class="carousel-title" style="padding: 0; color: #7b7f5f; font-size: 1.3em; font-family: 'News Cycle', 'Arial Narrow Bold', sans-serif; font-weight: bold; text-align: center; width: 100%;  margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">Summary Popups</p>
<p class="fw-light" style="padding: 10px 0; color: #000; font-size: 0.7em; text-align: center; width: 100%;  margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">Clicking a landslide point in district view displays a popup with aggregated details, aiding understanding of past events at specific locations.</p>
<div class="image-row" style="padding: 10px 0; width: 100%;  text-align: center; margin: 0 auto; box-sizing: border-box;">
<a href="">
<img src="images/App_popup.png" class="d-block" style="width: 100%;  max-height: 300px; height: auto; object-fit: contain; margin: 0 auto;">
</a>
</div>
<div class="code-row" style="padding: 10px 0; width: 100%;  text-align: center; margin: 0 auto; box-sizing: border-box;">
<div class="code-snippet" style="font-family: 'Courier New', monospace; font-size: 0.8em; background-color: #f5f5f5; padding: 8px; border-radius: 3px; width: 90%; height: 200px; overflow-y: auto; white-space: pre-wrap; text-align: left; margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">// Detect landslide points within buffer and aggregate data
var clickRadius = 0.0027; // ~300 meters
var matchingFeatures = [];
clippedLandslideFeatures.forEach(function(feature) {
var featureCoords = feature.geometry.coordinates;
var distance = Math.sqrt(
Math.pow(clickLon - featureLon, 2) + Math.pow(clickLat - featureLat, 2)
);
if (distance &lt; clickRadius) {
matchingFeatures.push(feature);
}
});

if (matchingFeatures.length &gt; 0) {
var totalDeaths = 0, totalInjuries = 0, incidentCount = matchingFeatures.length;
matchingFeatures.forEach(function(feature) {
var props = feature.properties || {};
totalDeaths += props.peopleDeathCount || 0;
totalInjuries += props.peopleInjuredCount || 0;
});
showLandslidePopup({ incidentCount: incidentCount, totalDeaths: totalDeaths, totalInjuries: totalInjuries });
}

// Display aggregated data in popup
function showLandslidePopup(aggregatedData, coords) {
var titleTemplate = translate('Landslide Events ({0} Incidents)');
var title = titleTemplate.replace('{0}', aggregatedData.incidentCount);
contentPanel.add(ui.Label(title, { fontSize: '16px', fontWeight: 'bold' }));
contentPanel.add(createRow('Deaths:', aggregatedData.totalDeaths));
contentPanel.add(createRow('Injuries:', aggregatedData.totalInjuries));
}</div>
</div>
</div>
<div class="carousel-item" style="width: 100%; height: 100%; padding: 20px 70px; text-align: center; box-sizing: border-box;" data-bs-interval="5000">
<p class="carousel-title" style="padding: 0; color: #7b7f5f; font-size: 1.3em; font-family: 'News Cycle', 'Arial Narrow Bold', sans-serif; font-weight: bold; text-align: center; width: 100%;  margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">Interactive Analysis</p>
<p class="fw-light" style="padding: 10px 0; color: #000; font-size: 0.7em; text-align: center; width: 100%;  margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">Users can interact with districts by clicking on the map, selecting from a dropdown, or using connected charts, enabling seamless data exploration.</p>
<div class="image-row" style="padding: 10px 0; width: 100%;  text-align: center; margin: 0 auto; box-sizing: border-box;">
<a href="">
<img src="images/App_interactivity.png" class="d-block" style="width: 100%;  max-height: 300px; height: auto; object-fit: contain; margin: 0 auto;">
</a>
</div>
<div class="code-row" style="padding: 10px 0; width: 100%;  text-align: center; margin: 0 auto; box-sizing: border-box;">
<div class="code-snippet" style="font-family: 'Courier New', monospace; font-size: 0.8em; background-color: #f5f5f5; padding: 8px; border-radius: 3px; width: 90%; height: 200px; overflow-y: auto; white-space: pre-wrap; text-align: left; margin: 0 auto; word-wrap: break-word; box-sizing: border-box;">// Chart interaction in national overview
topDistrictsChart.onClick(function(district) {
if (district) {
var originalDistrictName = district.toUpperCase();
selectDistrict(originalDistrictName);
}
});

// Alternative: District dropdown selection
districtSelect = ui.Select({
items: districtSelectItems,
placeholder: translate('Select District:'),
onChange: function(value) {
if (value === 'National Overview') {
resetToNationalView();
} else {
selectDistrict(value);
}
}
});

// Alternative: Map click selection
Map.onClick(function(coords) {
var point = ee.Geometry.Point(coords.lon, coords.lat);
var clickedDistrict = districts.filterBounds(point).first();
if (clickedDistrict) {
clickedDistrict.get('DISTRICT').evaluate(function(districtName) {
districtName = districtName.trim().toUpperCase();
selectDistrict(districtName);
});
} });</div>
</div>
</div>
</div>
<button class="carousel-control-prev" type="button" data-bs-target="#gallery-carousel" data-bs-slide="prev">
<span class="carousel-control-prev-icon" aria-hidden="true"></span>
<span class="visually-hidden">Previous</span>
</button>
<button class="carousel-control-next" type="button" data-bs-target="#gallery-carousel" data-bs-slide="next">
<span class="carousel-control-next-icon" aria-hidden="true"></span>
<span class="visually-hidden">Next</span>
</button>
</div>
</div>
</div>
</section>
</section>
<section id="how-it-works" class="level2">
<h2 class="anchored" data-anchor-id="how-it-works">How it Works</h2>
<section id="data-preparation-and-precomputations" class="level3">
<h3 class="anchored" data-anchor-id="data-preparation-and-precomputations">1. Data Preparation and Precomputations</h3>
<p>To handle complex computations, separate scripts were developed for the two methodologies explained above. Results are imported into the app as precomputed layers.</p>
<section id="imported-precomputed-layers" class="level4">
<h4 class="anchored" data-anchor-id="imported-precomputed-layers">Imported Precomputed Layers:</h4>
<ul>
<li><p>Environmental Landslide Susceptibility: Maps susceptibility using environmental variables.</p></li>
<li><p>Normalized Landslide Susceptibility: Adjusted for population exposure.</p></li>
<li><p>Random Forest Landslide Probability: ML-based risk focused on populated areas.</p></li>
</ul>
</section>
<section id="district-level-aggregation" class="level4">
<h4 class="anchored" data-anchor-id="district-level-aggregation">District-Level Aggregation:</h4>
<p>A dedicated script was built to aggregate historical reported landslide data with impact metrics (e.g., incidents, deaths, injuries, destroyed infrastructure), alongside population and susceptibility metrics per district. It also includes engineered metrics such as incidents per km² and nearest districts (determined via spatial proximity of centroids) for comparative analysis.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Compute distances to other districts and find two nearest neighbors using precomputed centroids</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> districtsWithDistance <span class="op">=</span> districtFactors<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(otherDistrict) {</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> otherName <span class="op">=</span> otherDistrict<span class="op">.</span><span class="fu">get</span>(<span class="st">'DISTRICT'</span>)<span class="op">;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> lon2 <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(otherDistrict<span class="op">.</span><span class="fu">get</span>(<span class="st">'centroid_lon'</span>))<span class="op">;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> lat2 <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(otherDistrict<span class="op">.</span><span class="fu">get</span>(<span class="st">'centroid_lat'</span>))<span class="op">;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Approximate distance using Euclidean distance in lat/lon </span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> distance <span class="op">=</span> lon1<span class="op">.</span><span class="fu">subtract</span>(lon2)<span class="op">.</span><span class="fu">pow</span>(<span class="dv">2</span>)<span class="op">.</span><span class="fu">add</span>(lat1<span class="op">.</span><span class="fu">subtract</span>(lat2)<span class="op">.</span><span class="fu">pow</span>(<span class="dv">2</span>))<span class="op">.</span><span class="fu">sqrt</span>()<span class="op">;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> otherDistrict<span class="op">.</span><span class="fu">set</span>(<span class="st">'distance'</span><span class="op">,</span> distance)<span class="op">;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> nearbyDistricts <span class="op">=</span> districtsWithDistance</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">neq</span>(<span class="st">'DISTRICT'</span><span class="op">,</span> districtName))</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">sort</span>(<span class="st">'distance'</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">limit</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Extract the two nearest neighbors</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> neighbor1 <span class="op">=</span> nearbyDistricts<span class="op">.</span><span class="fu">first</span>()<span class="op">;</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> neighbor2 <span class="op">=</span> nearbyDistricts<span class="op">.</span><span class="fu">toList</span>(<span class="dv">2</span>)<span class="op">.</span><span class="fu">get</span>(<span class="dv">1</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="interactive-visualization-and-analysis" class="level3">
<h3 class="anchored" data-anchor-id="interactive-visualization-and-analysis">2. Interactive Visualization and Analysis</h3>
<section id="national-overview" class="level4">
<h4 class="anchored" data-anchor-id="national-overview">National Overview</h4>
<p>At startup, national-level statistics are displayed, highlighting aggregated data. A pie chart shows population risk distribution across susceptibility zones (Low, Medium, High), and a bar chart lists the top 5 districts by impact metric, allowing users to switch metrics and zoom into a district by clicking a bar.</p>
</section>
<section id="susceptibility-zones" class="level4">
<h4 class="anchored" data-anchor-id="susceptibility-zones">Susceptibility Zones</h4>
<p>Susceptibility zones are defined as Low (&lt;0.3), Medium (0.3–0.5), and High (&gt;0.5), identified by analyzing the distribution of susceptibility values from the built Susceptibility model.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Generate a histogram of susceptibility values</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> histogram <span class="op">=</span> LandslideSusceptibility<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">histogram</span>({<span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">steps</span><span class="op">:</span> <span class="dv">100</span>})<span class="op">,</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometry</span><span class="op">:</span> NepalBoundary<span class="op">.</span><span class="fu">geometry</span>()<span class="op">,</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">1000</span><span class="op">,</span> <span class="co">// Match the scale used in the app for consistency</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">maxPixels</span><span class="op">:</span> <span class="fl">1e10</span><span class="op">,</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">bestEffort</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">// Extract the histogram data</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> histogramDict <span class="op">=</span> ee<span class="op">.</span><span class="fu">Dictionary</span>(histogram<span class="op">.</span><span class="fu">get</span>(<span class="st">'susceptibility'</span>))<span class="op">;</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> values <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>(histogramDict<span class="op">.</span><span class="fu">get</span>(<span class="st">'histogram'</span>))<span class="op">;</span> <span class="co">// Frequency counts</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> bucketEdges <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>(histogramDict<span class="op">.</span><span class="fu">get</span>(<span class="st">'bucketMeans'</span>))<span class="op">;</span> <span class="co">// Bin centers</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">// Define susceptibility zones based on histogram-derived thresholds</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> thresholdZones <span class="op">=</span> LandslideSusceptibility</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">where</span>(LandslideSusceptibility<span class="op">.</span><span class="fu">lt</span>(<span class="fl">0.3</span>)<span class="op">,</span> <span class="dv">1</span>) <span class="co">// Low Risk: &lt; 0.3</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">where</span>(LandslideSusceptibility<span class="op">.</span><span class="fu">gte</span>(<span class="fl">0.3</span>)<span class="op">.</span><span class="fu">and</span>(LandslideSusceptibility<span class="op">.</span><span class="fu">select</span>(<span class="st">'slope'</span>)<span class="op">.</span><span class="fu">lte</span>(<span class="fl">0.5</span>))<span class="op">,</span> <span class="dv">2</span>) <span class="co">// Medium Risk: 0.3–0.5</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">where</span>(LandslideSusceptibility<span class="op">.</span><span class="fu">gt</span>(<span class="fl">0.5</span>)<span class="op">,</span> <span class="dv">3</span>) <span class="co">// High Risk: &gt; 0.5</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">rename</span>(<span class="st">'zone'</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">updateMask</span>(LandslideSusceptibility<span class="op">.</span><span class="fu">mask</span>())</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">clip</span>(NepalBoundary)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="district-level-analysis" class="level4">
<h4 class="anchored" data-anchor-id="district-level-analysis">District-Level Analysis</h4>
<p>This view provides detailed district analysis, showing key metrics like average susceptibility, population, and incidents per km², alongside comparisons with national averages and the two nearest districts. Historical landslides are visualized on the map, with popups displaying aggregated details within a 300m radius of a clicked point.</p>
</section>
<section id="methodology-overview" class="level4">
<h4 class="anchored" data-anchor-id="methodology-overview">Methodology Overview</h4>
<p>This view allows users to compare the two methodologies (Environmental Susceptibility and RF) using a split panel. It displays the RF probability map and normalized risk map for populated areas, with a draggable divider for spatial comparison, focusing on population exposure.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Initialize split maps with layers</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> leftMap <span class="op">=</span> ui<span class="op">.</span><span class="fu">Map</span>()<span class="op">;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> rightMap <span class="op">=</span> ui<span class="op">.</span><span class="fu">Map</span>()<span class="op">;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Add risk layers to split maps</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> leftProbabilityLayer <span class="op">=</span> ui<span class="op">.</span><span class="at">Map</span><span class="op">.</span><span class="fu">Layer</span>(probabilityLayer<span class="op">.</span><span class="fu">getEeObject</span>()<span class="op">,</span> probabilityLayer<span class="op">.</span><span class="fu">getVisParams</span>()<span class="op">,</span> <span class="fu">translate</span>(<span class="st">'RF Landslide Probability (Populated Areas)'</span>))<span class="op">;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>leftMap<span class="op">.</span><span class="fu">layers</span>()<span class="op">.</span><span class="fu">add</span>(leftProbabilityLayer)<span class="op">;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> rightNormalizedRiskLayer <span class="op">=</span> ui<span class="op">.</span><span class="at">Map</span><span class="op">.</span><span class="fu">Layer</span>(normalizedRiskLayer<span class="op">.</span><span class="fu">getEeObject</span>()<span class="op">,</span> normalizedRiskLayer<span class="op">.</span><span class="fu">getVisParams</span>()<span class="op">,</span> <span class="fu">translate</span>(<span class="st">'Landslide Susceptibility (Populated Areas)'</span>))<span class="op">;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>rightMap<span class="op">.</span><span class="fu">layers</span>()<span class="op">.</span><span class="fu">add</span>(rightNormalizedRiskLayer)<span class="op">;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">// Link maps for synchronized zooming and panning</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> mapLinker <span class="op">=</span> ui<span class="op">.</span><span class="at">Map</span><span class="op">.</span><span class="fu">Linker</span>([leftMap<span class="op">,</span> rightMap])<span class="op">;</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">// Set up the split panel for comparison</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> splitPanel <span class="op">=</span> ui<span class="op">.</span><span class="fu">SplitPanel</span>({</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a> <span class="dt">firstPanel</span><span class="op">:</span> leftMap<span class="op">,</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a> <span class="dt">secondPanel</span><span class="op">:</span> rightMap<span class="op">,</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a> <span class="dt">orientation</span><span class="op">:</span> <span class="st">'horizontal'</span><span class="op">,</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a> <span class="dt">wipe</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="insights-and-objectives" class="level3">
<h3 class="anchored" data-anchor-id="insights-and-objectives">3. Insights and Objectives</h3>
<p>The app provides actionable insights for disaster preparedness in Nepal by identifying high-risk districts and population exposure. It supports:</p>
<ul>
<li><p><strong>Risk Prioritization:</strong> Highlights districts with high susceptibility or incident rates (e.g., top 5 districts by deaths) to guide resource allocation.</p></li>
<li><p><strong>Localized Insights:</strong> Enables district-level analysis for targeted planning and response, benefiting community preparedness efforts.</p></li>
<li><p><strong>Academic Research:</strong> Unlike traditional landslide models in academic papers, this app provides an interactive platform for exploring risk dynamics through a comparison of Environmental Susceptibility and Random Forest methodologies, leveraging incidents data. By masking to populated areas, it focuses on human exposure, as official records often under-report incidents in uninhabited regions, ensuring more accurate risk assessment and model comparison for populated zones.</p></li>
</ul>
</section>
<section id="limitations-and-potential-expansion" class="level3">
<h3 class="anchored" data-anchor-id="limitations-and-potential-expansion">4. Limitations and Potential Expansion</h3>
<ul>
<li><p><strong>Static Models:</strong> Current models are precomputed, limiting adaptability to changing environmental conditions. Adding dynamic updates with live data (e.g., rainfall, land use changes) could improve accuracy and responsiveness.</p></li>
<li><p><strong>Granularity of Analysis:</strong> The app focuses on district-level analysis, but more granular insights (e.g., at the village or ward level) could improve localized planning.</p></li>
<li><p><strong>Report Export:</strong> The app lacks a feature to export analysis reports, which would be valuable for stakeholders to document and share findings.</p></li>
</ul>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<ul>
<li><p>Chalise, A., Sinjali, B., Kandel, T., Parajuli, J., &amp; Shrestha, S. (2022). Landslide Susceptibility Mapping Using Machine Learning Approach: A Case Study of Baglung District, Nepal. Nepalese Journal of Geoinformatics, 31–41. https://doi.org/10.3126/njg.v21i1.50880</p></li>
<li><p>Chen, L., Ge, X., Yang, L., Li, W. and Peng, L. (2023) An Improved Multi-Source Data-Driven Landslide Prediction Method Based on Spatio-Temporal Knowledge Graph, Remote sensing, 15(8), p.&nbsp;2126, [online] Available at: https://www.mdpi.com/2072-4292/15/8/2126/pdf?version=1681786952.</p></li>
<li><p>Meena, S.R., Albrecht, F., Hölbling, D., Ghorbanzadeh, O. and Blaschke, T. (2021). Nepalese landslide information system (NELIS): a conceptual framework for a web-based geographical information system for enhanced landslide risk management in Nepal. Natural Hazards and Earth System Sciences, [online] 21(1), pp.301–316. doi:https://doi.org/10.5194/nhess-21-301-2021.</p></li>
<li><p>Nepal in data, n.d. Major Languages Spoken As Mother Tongue in Nepal. Available at: https://nepalindata.com/insight/major-languages-spoken-as-mother-tongue-in-nepal/</p></li>
<li><p>Hong, Y., Adler, R. &amp; Huffman, G., 2007. Use of satellite remote sensing data in the mapping of global landslide susceptibility. Natural Hazards, 43(2), pp.245–256. Available at: https://doi.org/10.1007/s11069-006-9104-z</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/maheer-maps\.github\.io\/CASA25_Rasternauts\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<div style="text-align: left">
CASA0025 Group Project
</div>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Maheer-Maps/CASA25_Rasternauts" target="_blank">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>